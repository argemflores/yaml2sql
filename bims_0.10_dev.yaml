---
dictionary:
    column:
        - &id-col
            name: id
            data_type: serial
            not_null: true
            type: system
            comment: Primary key of the record in the table
        - &abbrev-col
            name: abbrev
            data_type: varchar
            length: 128
            not_null: true
            type: system
            comment: Short name identifier or abbreviation of the record
        - &name-col
            name: name
            data_type: varchar
            length: 256
            not_null: true
            type: identification
            comment: Name identifier
        - &description-col
            name: description
            data_type: text
            type: metadata
            comment: Description
        - &remarks-col
            name: remarks
            data_type: text
            type: metadata
            comment: Additional details
        - &creation_timestamp-col
            name: creation_timestamp
            data_type: timestamp
            not_null: true
            default_value: now()
            type: system
            comment: Timestamp when the record was added to the table
        - &creator_id-col
            name: creator_id
            data_type: integer
            not_null: true
            comment: ID of the user who added the record to the table
            type: system
            default_value: 1
        - &modification_timestamp-col
            name: modification_timestamp
            data_type: timestamp
            type: system
            comment: Timestamp when the record was last modified
        - &modifier_id-col
            name: modifier_id
            data_type: integer
            type: system
            comment: ID of the user who last modified the record
        - &notes-col
            name: notes
            data_type: text
            type: system
            comment: Additional details added by an admin; can be technical or advanced details
        - &is_void-col
            name: is_void
            data_type: boolean
            not_null: true
            default_value: false
            type: system
            comment: Indicator whether the record is deleted or not
        - &order_number-col
            name: order_number
            data_type: integer
            not_null: true
            default_value: 1
            type: system
            comment: Ordering number
        - &user_id-col
            name: user_id
            data_type: integer
            not_null: true
            type: system
            comment: ID of user
        - &comment-col
            name: comment
            data_type: text
            type: system
            comment: Additional details
        - &database_id-col
            name: database_id
            data_type: integer
            not_null: true
            type: system
            comment: ID of the database to use as reference key
        - &schema_id-col
            name: schema_id
            data_type: integer
            not_null: true
            type: system
            comment: ID of the schema to use as reference key
        - &table_id-col
            name: table_id
            data_type: integer
            not_null: true
            type: system
            comment: ID of the table to use as reference key
        - &column_id-col
            name: column_id
            data_type: integer
            not_null: true
            type: system
            comment: ID of the column to use as reference key
        - &constraint_id-col
            name: constraint_id
            data_type: integer
            not_null: true
            type: system
            comment: ID of the constraint to use as reference key
        - &index_id-col
            name: index_id
            data_type: integer
            not_null: true
            type: system
            comment: ID of the index to use as reference key
        - &product_id-col
            name: product_id
            data_type: integer
            not_null: true
            type: system
            comment: ID of the product in the product table
        - &gid-col
            name: gid
            data_type: integer
            not_null: true
            type: metadata
            comment: ID of germplasm from the IRIS GMS database; related to the germplasm's seed stocks
        - &rep-col
            name: rep
            data_type: integer
            not_null: true
            default_value: 1
            type: identification
            comment: Replication number of an entry in the plot
        - &study_id-col
            name: study_id
            data_type: integer
            not_null: true
            type: system
            comment: Study
        - &entry_id-col
            name: entry_id
            data_type: integer
            not_null: true
            type: system
            comment: Entry of the study
        - &plot_id-col
            name: plot_id
            data_type: integer
            not_null: true
            type: system
            comment: Plot
        - &subplot_id-col
            name: subplot_id
            data_type: integer
            not_null: true
            type: system
            comment: Subplot
        - &variable_id-col
            name: variable_id
            data_type: integer
            not_null: true
            type: system
            comment: Variable
        - &value-col
            name: value
            data_type: varchar
            not_null: true
            type: metadata
            comment: Value of a variable
        - &key-col
            name: key
            data_type: numeric
            not_null: true
            type: identification
            comment: Key
        - &number-col
            name: number
            data_type: integer
            not_null: true
            type: identification
            default_value: 1
        - &code-col
            name: code
            data_type: varchar
            type: metadata
            comment: Coded value
        - &status-col
            name: status
            data_type: varchar
            type: system
            length: 32
        - &title-col
            name: title
            data_type: varchar
            type: metadata
            comment: Title
        - &transaction_id-col
            name: transaction_id
            data_type: integer
            not_null: true
            type: system
            comment: ID of the transaction made in the terminal
        - &program_id-col
            name: program_id
            data_type: integer
            type: system
            not_null: true
            comment: Product development program
        - &place_id-col
            name: place_id
            data_type: integer
            not_null: true
            type: system
            comment: Place
        - &phase_id-col
            name: phase_id
            data_type: integer
            not_null: true
            type: system
            comment: 'Breeding stage (HB, F1, F2, etc.) or special experiment (RGA, SI, etc.)'
        - &year-col
            name: year
            data_type: integer
            not_null: true
            type: metadata
            comment: Year
        - &season_id-col
            name: season_id
            data_type: integer
            not_null: true
            type: system
            comment: Season
        - &display_name-col
            name: display_name
            data_type: varchar
            length: 256
            type: metadata
            comment: Name to show to users
        - &item_id-col
            name: item_id
            data_type: integer
            not_null: true
            type: system
            comment: Item
    constraint:
        - &id-pkey-cst
            name: {table}_id_pkey
            type: primary_key
            column: id
            comment: Primary key constraint for the id column
        - &creator_id-fkey-cst
            name: {table}_creator_id_fkey
            type: foreign_key
            column: creator_id
            comment: 'Foreign key constraint for the creator_id column, which refers to the id column of master.user table'
            other_attributes:
                foreign_table: master.user
                foreign_column: id
        - &modifier_id-fkey-cst
            name: {table}_modifier_id_fkey
            type: foreign_key
            column: modifier_id
            comment: 'Foreign key constraint for the modifier_id column, which refers to the id column of the master.user table'
            other_attributes:
                foreign_table: master.user
                foreign_column: id
        - &user_id-fkey-cst
            name: {table}_user_id_fkey
            type: foreign_key
            column: user_id
            comment: 'Foreign key constraint for the user_id column, which refers to the id column of the master.user table'
            other_attributes:
                foreign_table: master.user
                foreign_column: id
        - &database_id-fkey-cst
            name: {table}_database_id_fkey
            type: foreign_key
            column: database_id
            comment: 'Foreign key constraint for the database_id column, which refers to the id column of the dictionary.database table'
            other_attributes:
                foreign_table: dictionary.database
                foreign_column: id
        - &schema_id-fkey-cst
            name: {table}-schema_id_fkey
            type: foreign_key
            column: schema_id
            comment: 'Foreign key constraint for the schema_id column, which refers to the id column of the dictionary.schema table'
            other_attributes:
                foreign_table: dictionary.schema
                foreign_column: id
        - &table_id-fkey-cst
            name: {table}_table_id_fkey
            type: foreign_key
            column: table_id
            comment: 'Foreign key constraint for the table_id column, which refers to the id column of the dictionary.table table'
            other_attributes:
                foreign_table: dictionary.table
                foreign_column: id
        - &column_id-fkey-cst
            name: {table}_column_id_fkey
            type: foreign_key
            column: column_id
            comment: 'Foreign key constraint for the column_id column, which refers to the id column of the dictionary.column table'
            other_attributes:
                foreign_table: dictionary.column
                foreign_column: id
        - &constraint_id-fkey-cst
            name: {table}_constraint_id_fkey
            type: foreign_key
            column: constraint_id
            comment: 'Foreign key constraint for the constraint_id column, which refers to the id column of the dictionary.constraint table'
            other_attributes:
                foreign_table: dictionary.constraint
                foreign_column: id
        - &index_id-fkey-cst
            name: {table}_index_id_fkey
            type: foreign_key
            column: index_id
            comment: 'Foreign key constraint for the index_id column, which refers to the id column of the dictionary.index table'
            other_attributes:
                foreign_table: dictionary.index
                foreign_column: id
        - &variable_id-fkey-cst
            name: {table}_variable_id_fkey
            type: foreign_key
            column: variable_id
            comment: 'Foreign key constraint for the variable_id column, which refers to the id column of the master.variable table'
            other_attributes:
                foreign_table: master.variable
                foreign_column: id
        - &product_id-fkey-cst
            name: {table}_product_id_fkey
            type: foreign_key
            column: product_id
            comment: 'Foreign key constraint for the product_id column, which refers to the id column of the master.product table'
            other_attributes:
                foreign_table: master.product
                foreign_column: id
        - &study_id-fkey-cst
            name: {table}_study_id_fkey
            type: foreign_key
            column: study_id
            comment: 'Foreign key constraint for the study_id column, which refers to the id column of the study table'
            other_attributes:
                foreign_table: {schema}.study
                foreign_column: id
        - &entry_id-fkey-cst
            name: {table}_entry_id_fkey
            type: foreign_key
            column: entry_id
            comment: 'Foreign key constraint for the entry_id column, which refers to the id column of the entry table'
            other_attributes:
                foreign_table: {schema}.entry
                foreign_column: id
        - &plot_id-fkey-cst
            name: {table}_plot_id_fkey
            type: foreign_key
            column: plot_id
            comment: 'Foreign key constraint for the plot_id column, which refers to the id column of the plot table'
            other_attributes:
                foreign_table: {schema}.plot
                foreign_column: id
        - &subplot_id-fkey-cst
            name: {table}_subplot_id_fkey
            type: foreign_key
            column: subplot_id
            comment: 'Foreign key constraint for the subplot_id column, which refers to the id column of the subplot table'
            other_attributes:
                foreign_table: {schema}.subplot
                foreign_column: id
        - &transaction_id-fkey-cst
            name: {table}_transaction_id_fkey
            type: foreign_key
            column: transaction_id
            comment: 'Foreign key constraint for the transaction_id column, which refers to the id column of the transaction table'
            other_attributes:
                foreign_table: {schema}.transaction
                foreign_column: id
    index:
        - &abbrev-idx
            name: {table}_abbrev_idx
            column: abbrev
            unique: true
            comment: Unique index for the abbrev column
        - &is_void-idx
            name: {table}_is_void_idx
            column: is_void
            comment: Index for the is_void column
        - &user_id-idx
            name: {table}_user_id_idx
            column: user_id
            comment: Index for the user_id column
        - &database_id-idx
            name: {table}_database_id_idx
            column: database_id
            comment: Index for the database_id column
        - &schema_id-idx
            name: {table}-schema_id_idx
            column: schema_id
            comment: Index for the schema_id column
        - &table_id-idx
            name: {table}_table_id_idx
            column: table_id
            comment: Index for the table_id column
        - &column_id-idx
            name: {table}-column_id_idx
            column: column_id
            comment: Index for the column_id column
        - &constraint_id-idx
            name: {table}_constraint_id_idx
            column: constraint_id
            comment: Index for the constraint_id column
        - &index_id-idx
            name: {table}_index_id_idx
            column: index_id
            comment: Index for the index_id column
        - &product_id-idx
            name: {table}_product_id_idx
            column: product_id
            comment: Index for the product_id column
        - &variable_id-idx
            name: {table}_variable_id_idx
            column: variable_id
            comment: Index for the variable_id column
        - &key-idx
            name: {table}_key_idx
            column: key
            unique: true
            comment: Index for the key column
        - &study_id-idx
            name: {table}_study_id_idx
            column: study_id
            comment: Index for the study_id column
        - &entry_id-idx
            name: {table}_entry_id_idx
            column: entry_id
            comment: Index for the entry_id column
        - &plot_id-idx
            name: {table}_plot_id_idx
            column: plot_id
            comment: Index for the plot_id column
        - &subplot_id-idx
            name: {table}_subplot_id_idx
            column: variable_id
            comment: Index for the subplot_id column
        - &transaction_id-idx
            name: {table}_transaction_id_idx
            column: transaction_id
            comment: Index for the transaction_id column
    value:
        - &copy-val
            column:
            from: |
                {curdir}\\{schema}.{table}.csv
            option: &copy-opt-val
                stdin: true
                format: csv
                header: header
                list: &copy-opt-list-val
                    delimiter: |
                        ';'
                    quote: |
                        '"'
                    escape: |
                        e'\\'
                    null: |
                        ''
    set:
        column:
            - &def-id-tbl-col
                - *id-col
            - &def-meta-tbl-col
                - *abbrev-col
                - *name-col
            - &def-desc-tbl-col
                - *description-col
                - *display_name-col
            - &def-log-tbl-col
                - *remarks-col
                - *creation_timestamp-col
                - *creator_id-col
                - *modification_timestamp-col
                - *modifier_id-col
                - *notes-col
                - *is_void-col
        constraint:
            - &def-log-tbl-cst
                - *id-pkey-cst
                - *creator_id-fkey-cst
                - *modifier_id-fkey-cst
        index:
            - &def-ident-tbl-idx
                - *abbrev-idx
            - &def-log-tbl-idx
                - *is_void-idx
    table:
        - &def-tbl
            name: {table}
            comment:
            column: &def-tbl-col
                <<: *def-id-tbl-col
                <<: *def-meta-tbl-col
                <<: *def-desc-tbl-col
                <<: *def-log-tbl-col
            constraint: &def-tbl-cst
                <<: *def-log-tbl-cst
            index: &def-tbl-idx
                <<: *def-ident-tbl-idx
                <<: *def-log-tbl-idx
database: &bims_0.10_dev-db
    name: bims_0.10_dev
    comment: |
        BIMS: Breeding Information Management System
        
        Wiki: https://sites.google.com/a/irri.org/bim/conceptual-model
        Concepts: https://docs.google.com/a/irri.org/document/d/1hSNKmbFLMzLrYyGLxBvBwRMQWpYzXeqpf8v_v0Hhpo0/edit#
    encoding: UTF8
    lc_collate: C
    lc_ctype: C
    schema:
        - &master-sch
            name: master
            comment: |
                Stores master data, which are absolutely correct data that does not change frequently
            table:
                - &master-user-tbl
                    <<: *def-tbl
                    name: user
                    comment: |
                        Registered users in the system are granted with roles and are assigned to one or more teams.
                    column:
                        <<: *def-id-tbl-col
                        - &user-email-col
                            name: email
                            data_type: varchar
                            length: 64
                            not_null: true
                            type: identification
                            comment: Active email address of the user. Currently supports IRRI email addresses.
                        - &user-username-col
                            name: username
                            data_type: varchar
                            length: 64
                            not_null: true
                            type: identification
                            comment: Unique username of the user taken from email address by removing all characters after and including the '@' sign
                        - &user-user_type-col
                            name: user_type
                            data_type: integer
                            not_null: true
                            type: system
                            comment: Administrator (admin) or non-admin
                        - &user-status-col
                            name: status
                            data_type: varchar
                            not_null: true
                            default_value: active
                            type: system
                            comment: Whether the user can log in to the system (active) or not (inactive)
                        - &user-last_name-col
                            name: last_name
                            data_type: varchar
                            length: 32
                            not_null: true
                            type: metadata
                            comment: Last name or family name of the user
                        - &user-first_name-col
                            name: first_name
                            data_type: varchar
                            length: 32
                            not_null: true
                            type: metadata
                            comment: First or given name of the user
                        - &user-middle_name-col
                            name: middle_name
                            data_type: varchar
                            length: 32
                            type: metadata
                            comment: Middle name of the user
                        - &user-display_name-col
                            name: display_name
                            data_type: varchar
                            length: 64
                            not_null: true
                            type: metadata
                            comment: Name of the user to be displayed in the system
                        - &user-salutation-col
                            name: salutation
                            data_type: varchar
                            length: 16
                            type: metadata
                            comment: Name to address the user in some parts of the system like the user profile
                        - &user-valid_start_date-col
                            name: valid_start_date
                            data_type: date
                            type: system
                            comment: Start date to allow the user to use the system
                        - &user-valid_end_date-col
                            name: valid_end_date
                            data_type: date
                            type: system
                            comment: Last date allowed for the user to use the system 
                        <<: *def-log-tbl-col
                    constraint:
                        -
                            type: unique_key
                            column: email
                        -
                            type: unique_key
                            column: username
                        <<: *def-log-tbl-cst
                    index:
                        - &user-email-idx
                            name: user_email_idx
                            column: email
                            unique: true
                        - &user-username-idx
                            name: user_username_idx
                            column: username
                            unique: true
                        <<: *def-log-tbl-idx
                    copy:
                        <<: *copy-val
                        column:
                            - id
                            - email
                            - username
                            - last_name
                            - first_name
                            - middle_name
                            - display_name
                            - status
                            - valid_start_date
                            - valid_end_date
                            - user_type
                    sequence:
                        restart: true
                        start_with: 25
                - &master-property-tbl
                    <<: *def-tbl
                    name: property
                    comment: |
                        Property describes the context of the sampling unit and experimental material, or the trait being measured.
                - &master-method-tbl
                    <<: *def-tbl
                    name: method
                    comment: |
                        Method describes how the property is applied or the protocol by which a variable is measured.
                    column:
                        <<: *def-id-tbl-col
                        - &method-abbrev-col
                            <<: *abbrev-col
                            comment: Short name for the method
                        - &method-name-col
                            <<: *name-col
                            comment: Name of the method or protocol to be applied
                        <<: *def-desc-tbl-col
                        -
                            name: formula
                            data_type: varchar
                            type: system
                            comment: Formula needed to compute for a property
                        <<: *def-log-tbl-col
                - &master-scale-tbl
                    <<: *def-tbl
                    name: scale
                    comment: |
                        Scale describes the units in which the variables are recorded.
                    column:
                        <<: *def-id-tbl-col
                        <<: *def-meta-tbl-col
                        - &scale-unit-col
                            name: unit
                            data_type: varchar
                            type: metadata
                            comment: Unit to use to measure a property
                        - &scale-type-col
                            name: type
                            data_type: varchar
                            # not_null: true
                            type: metadata
                            comment: 'Scale type: categorical; continuous; discrete'
                        - &scale-level-col
                            name: level
                            data_type: varchar
                            type: metadata
                            comment: 'Scale level: nominal; ordinal; interval; ratio'
                        <<: *def-desc-tbl-col
                        <<: *def-log-tbl-col
                - &master-scale_value-tbl
                    <<: *def-tbl
                    name: scale_value
                    comment: Discrete values a scale can have.
                    column:
                        <<: *def-id-tbl-col
                        - &scale_value-scale_id-col
                            name: scale_id
                            data_type: integer
                            not_null: true
                            type: system
                            comment: Scale to use the allowable value
                        - &scale_value-value-col
                            name: value
                            data_type: varchar
                            not_null: true
                            type: system
                            comment: Value in the scale
                        -
                            <<: *order_number-col
                            comment: Order of the value in the scale; -1 if order is not significant
                        -
                            <<: *description-col
                            comment: Additional information about the scale value
                        -
                            <<: *display_name-col
                            comment: Name to display or label of the scale value
                        <<: *def-log-tbl-col
                    constraint:
                        - &scale_value-scale_id-cst
                            name: scale_value_scale_id_fkey
                            type: foreign_key
                            column: scale_id
                            other_attributes:
                                foreign_table: master.scale
                                foreign_column: id
                        -
                            type: unique_key
                            column:
                                - scale_id
                                - value
                        <<: *def-log-tbl-cst
                    index:
                        - &scale_value-scale_id-idx
                            name: scale_value_scale_id_idx
                            column: scale_id
                        -
                            name: scale_value_scale_id_value_idx
                            column:
                                - scale_id
                                - value
                        -
                            name: scale_value_scale_id_order_number_idx
                            column:
                                - scale_id
                                - order_number
                        <<: *def-log-tbl-idx
                - &master-variable-tbl
                    <<: *def-tbl
                    name: variable
                    comment: |
                        A variable is a data element, which has precise meaning throughout the data model.
                        Each variable has a set of mandatory attributes, which are inherited by the children through the data model.
                    column:
                        <<: *def-id-tbl-col
                        - &variable-abbrev-col
                            <<: *abbrev-col
                            comment: Column name of the variable in the warehouse tables
                        - &variable-label-col
                            name: label
                            data_type: varchar
                            length: 128
                            type: identification
                            comment: Abbrev of the variable's property
                        - &variable-name-col
                            <<: *name-col
                            comment: Name of the variable or the variable's property
                        - &variable-data_type-col
                            name: data_type
                            data_type: varchar
                            type: system
                            comment: Type of data a variable can accept
                            # accepted_values: integer, float, varchar, text, bool, byte
                        - &variable-not_null-col
                            name: not_null
                            data_type: boolean
                            not_null: true
                            default_value: false
                            type: system
                            comment: Whether the variable can not be null (true) or nullable (false)
                        - &variable-type-col
                            name: type
                            data_type: varchar
                            length: 32
                            type: system
                            comment: |
                                Type of the variable in the system
                                1. system: contains values which are (usually) not displayed to the users of the system.
                                    For example study_id which is a surrogate key or a product_id which is a reference key to product catalog.
                                    This is automatically generated by the system.
                                2. identification: has values which are used as keys or part of a key, which will be used to verify the data integrity in study, entry and plot level.
                                    For instance entry_code, replication number. This is also automatically generated by the system.
                                3. metadata: has a wide range of data types aimed to store values, which will be useful to interpret the observation variable values.
                                    For instance entry count of a study, harvest date, remarks and pictures.
                                4. observation: used to store the values produced (measured, observed, computed, predicted) in various data production events,
                                    like for instance single trial analysis or plant height observation
                        - &variable-status-col
                            <<: *status-col
                            comment: Whether a variable is being actively used in the system (active) or not (deprecated)
                        - &variable-display_name-col
                            <<: *display_name-col
                            comment: Name of the variable to display in different parts of the system
                        - &variable-ontology_reference-col
                            name: ontology_reference
                            data_type: varchar
                            type: metadata
                            comment: Reference of the variable to the Rice Crop Ontology (http://www.cropontology.org/ontology/CO_320/Rice)
                        - &variable-bibliographical_reference-col
                            name: bibliographical_reference
                            data_type: varchar
                            type: metadata
                            comment: 'Reference to books (version, year, chapter, page, etc.) like SES or RD, where the variable was taken from'
                        - &variable-property_id-col
                            name: property_id
                            data_type: integer
                            type: system
                            comment: Property of the variable
                        - &variable-method_id-col
                            name: method_id
                            data_type: integer
                            type: system
                            comment: Method to measure the property of the variable
                        - &variable-scale_id-col
                            name: scale_id
                            data_type: integer
                            type: system
                            comment: Scale and allowable values a variable can have
                        - &variable-variable_set-col
                            name: variable_set
                            data_type: varchar
                            type: metadata
                            comment: Variable set where the variable belongs to
                        - &variable-synonym-col
                            name: synonym
                            data_type: varchar
                            type: metadata
                            comment: Additional entries about the synonyms of the variable
                        - &variable-description-col
                            <<: *description-col
                        <<: *def-log-tbl-col
                    constraint:
                        - &variable-property_id-fkey-cst
                            name: variable_property_id_fkey
                            type: foreign_key
                            column: property_id
                            other_attributes:
                                foreign_table: master.property
                                foreign_column: id
                        - &variable-method_id-fkey-cst
                            name: variable_method_id_fkey
                            type: foreign_key
                            column: method_id
                            other_attributes:
                                foreign_table: master.method
                                foreign_column: id
                        - &variable-scale_id-fkey-cst
                            name: variable_scale_id_fkey
                            type: foreign_key
                            column: scale_id
                            other_attributes:
                                foreign_table: master.scale
                                foreign_column: id
                        <<: *def-tbl-cst
                    index:
                        <<: *def-ident-tbl-idx
                        -
                            name: variable_label_idx
                            column: label
                        - &variable-property_id-idx
                            name: variable_property_id_idx
                            column: property_id
                        - &variable-method_id-idx
                            name: variable_method_id_idx
                            column: method_id
                        - &variable-scale_id-idx
                            name: variable_scale_id_idx
                            column: scale_id
                        - &variable-property_id-method_id-scale_id-idx
                            name: variable_property_id_method_id_scale_id_idx
                            column:
                                - property_id
                                - method_id
                                - scale_id
                        <<: *def-log-tbl-idx
                - &master-variable_set-tbl
                    <<: *def-tbl
                    name: variable_set
                    comment: Groups related variables together
                - &master-variable_set_member-tbl
                    <<: *def-tbl
                    name: variable_set_member
                    comment: List of variables belonging to a variable set
                    column:
                        <<: *def-id-tbl-col
                        - &variable_set_member-variable_set_id-col
                            name: variable_set_id
                            data_type: integer
                            not_null: true
                            type: system
                            comment: Variable set where the variables belong to
                        - &variable_set_member-variable_id-col
                            name: variable_id
                            data_type: integer
                            not_null: true
                            type: system
                            comment: Variable belonging to variable set
                        - &variable_set_member-order_number-col
                            name: order_number
                            data_type: integer
                            not_null: true
                            default_value: 1
                            type: system
                            comment: Order of the variable within the variable set
                        <<: *def-log-tbl-col
                    constraint:
                        - &variable_set_member-variable_set_id-fkey-cst
                            name: variable_set_member_variable_set_id_fkey
                            type: foreign_key
                            column: variable_set_id
                            other_attributes:
                                foreign_table: master.variable_set
                                foreign_column: id
                        - &variable_set_member-variable_id-fkey-cst
                            name: variable_set_member_variable_id_fkey
                            type: foreign_key
                            column: variable_id
                            other_attributes:
                                foreign_table: master.variable
                                foreign_column: id
                        -
                            type: unique_key
                            column:
                                - variable_set_id
                                - variable_id
                        -
                            type: unique_key
                            column:
                                - variable_set_id
                                - order_number
                        <<: *def-log-tbl-cst
                    index:
                        -
                            column: variable_set_id
                        -
                            column: variable_id
                        <<: *def-log-tbl-idx
                - &master-pipeline-tbl
                    <<: *def-tbl
                    name: pipeline
                    comment: |
                        A product development schema designed to develop breeding products to a certain demand (market segment).
                        At IRRI, VDPs are structured based on major regions and production ecologies
                            - Irrigated South East Asia (IRSEA)
                            - Rainfed lowland South East Asia (RFSEA)
                            - Irrigated South Asia (IRSA)
                            - Rainfed lowland South Asia (RFSA)
                            - Hybrid (HYB)
                            - Eastern Southern Africa (ESA) - has Rainfed and Irrigated TVP's, 
                            - Japonica (JAP) - has Temperate and Tropical TVP's
                    copy:
                        <<: *copy-val
                        column:
                            - abbrev
                            - name
                            - description
                - &master-crosscutting-tbl
                    <<: *def-tbl
                    name: crosscutting
                    comment: |
                        Breeding process that provides expert service for the whole breeding operation of an organization.
                        CCRD consists of a team of experts, the CCRD facility, and operational and capital resources.
                    copy:
                        <<: *copy-val
                        column:
                            - abbrev
                            - name
                            - description
                - &master-program-tbl
                    <<: *def-tbl
                    name: program
                    comment: |
                        Consist of variety development pipelines (VDPs), trait development teams and cross-cutting activities (CCRDs).
                        Products of VDPs are varieties, breeding lines, parental lines and other genetic materials in different stages of a breeding scheme, and IP related to the genetic materials.
                        Products of trait development are discovered trait donors, QTL's and genes, and marker application for selection of those, and related IP.
                        Trait development products work through different type IP-solutions than variety development.
                    column:
                        <<: *def-id-tbl-col
                        <<: *def-meta-tbl-col
                        -
                            name: pipeline_id
                            data_type: integer
                            not_null: true
                            type: system
                            comment: Pipeline
                        <<: *def-desc-tbl-col
                        <<: *def-log-tbl-col
                    constraint:
                        -
                            type: foreign_key
                            column: pipeline_id
                            other_attributes:
                                foreign_table: master.pipeline
                                foreign_column: id
                        <<: *def-tbl-cst
                    index:
                        -
                            column: pipeline_id
                        <<: *def-tbl-idx
                    copy:
                        <<: *copy-val
                        column:
                            - abbrev
                            - pipeline_id
                            - name
                            - description
                    sequence:
                        start_with: 101
                        minvalue: 101
                        maxvalue: 999
                - &master-place-tbl
                    <<: *def-tbl
                    name: place
                    comment: |
                        Represents the physical places and their segmentations such as geographies, locations, areas, zones, etc.
                            - Breeding hub
                            - Breeding location
                            - Facility
                            - Field
                            - Farm
                            - Glasshouse
                            - Warehouse
                            - Storage
                    copy:
                        <<: *copy-val
                        column:
                            - abbrev
                            - name
                            - description
                    sequence:
                        start_with: 10001
                        minvalue: 10001
                        maxvalue: 99999
                - &master-phase-tbl
                    <<: *def-tbl
                    name: phase
                    comment: Breeding development phases; a step having agreed name in an agreed breeding schema
                    copy:
                        <<: *copy-val
                        column:
                            - abbrev
                            - name
                            - description
                    sequence:
                        start_with: 101
                        minvalue: 101
                        maxvalue: 999
                - &master-scheme-tbl
                    <<: *def-tbl
                    name: scheme
                    comment: Breeding schemes
                    column:
                        <<: *def-id-tbl-col
                        <<: *def-meta-tbl-col
                        -
                            name: pipeline_id
                            data_type: integer
                            type: system
                            comment: Pipeline
                        -
                            name: program_id
                            data_type: integer
                            type: system
                            comment: Target variety program
                        -
                            name: phase_id
                            data_type: integer
                            type: system
                            comment: Breeding stage
                        -
                            <<: *order_number-col
                            comment: Order of phase in the program
                        -
                            name: type
                            data_type: varchar
                            type: metadata
                            comment: 'Type of breeding scheme: ID, SELECTION'
                        <<: *def-desc-tbl-col
                        <<: *def-log-tbl-col
                    constraint:
                        -
                            type: foreign_key
                            column: pipeline_id
                            other_attributes:
                                foreign_table: master.pipeline
                                foreign_column: id
                        -
                            type: foreign_key
                            column: program_id
                            other_attributes:
                                foreign_table: master.program
                                foreign_column: id
                        -
                            type: foreign_key
                            column: phase_id
                            other_attributes:
                                foreign_table: master.phase
                                foreign_column: id
                        -
                            type: unique_key
                            column:
                                - pipeline_id
                                - program_id
                                - phase_id
                        <<: *def-log-tbl-cst
                    index:
                        -
                            column: pipeline_id
                        -
                            column: program_id
                        -
                            column: phase_id
                        -
                            column:
                                - pipeline_id
                                - program_id
                                - phase_id
                        <<: *def-log-tbl-idx
                    copy:
                        <<: *copy-val
                        column:
                            - abbrev
                            - name
                            - description
                - &master-product-tbl
                    <<: *def-tbl
                    name: product
                    comment: |
                        Product catalog is a publicly accessible list of the products used and produced in product development programs.
                        Every record has a unique key and unique product name. It contains the identity of a material.
                    column:
                        <<: *def-id-tbl-col
                        - &product-program_id-col
                            name: program_id
                            data_type: integer
                            not_null: true
                            type: system
                            comment: |
                                Program where the product was created; foreign key referring to master.program table
                        - &product-designation-col
                            name: designation
                            data_type: varchar
                            not_null: true
                            type: identification
                            comment: Designation or name of the product
                        - &product-name_type-col
                            name: name_type
                            data_type: varchar
                            not_null: true
                            type: system
                            comment: |
                                Name type of the designation: breeding_line, fixed_line, derivative, common, cultivar
                        - &product-product_type-col
                            name: product_type
                            data_type: varchar
                            not_null: true
                            type: metadata
                            comment: |
                                Type of the product: progeny, fixed_line
                        - &product-year-col
                            name: year
                            data_type: integer
                            not_null: true
                            type: metadata
                            comment: Year when the product was created or acquired
                        - &product-season_id-col
                            name: season_id
                            data_type: integer
                            type: metadata
                            comment: |
                                Season when the product was created or acquired; foreign key referring to the master.season table
                        - &product-mta_status-col
                            name: mta_status
                            data_type: varchar
                            not_null: true
                            type: metadata
                            comment: |
                                Refers to the set of defined terms to guide the legal use of material i.e. SMTA, CMTA, OMTA, Confidential
                        - &product-parentage-col
                            name: parentage
                            data_type: varchar
                            type: metadata
                            comment: Pedigree details of the product
                        - &product-cross_id-col
                            name: cross_id
                            data_type: integer
                            type: system
                            comment: Refers to the cross id where the product was crossed; needs clarification
                        - &product-generation-col
                            name: generation
                            data_type: varchar
                            not_null: true
                            type: metadata
                            comment: |
                                Generation of the product: UNKNOWN, F1, BC1F1, BC2F1, BC3F1, F2, F3, F4, FIXED
                        - &product-iris_preferred_id-col
                            name: iris_preferred_id
                            data_type: varchar
                            type: metadata
                        - &product-breeding_line_name-col
                            name: breeding_line_name
                            data_type: varchar
                            type: metadata
                        - &product-derivative_name-col
                            name: derivative_name
                            data_type: varchar
                            type: metadata
                        - &product-fixed_line_name-col
                            name: fixed_line_name
                            data_type: varchar
                            type: metadata
                        - &product-selection_method-col
                            name: selection_method
                            data_type: varchar
                            type: metadata
                            comment: Method of selection of the product
                        <<: *def-desc-tbl-col
                        <<: *def-log-tbl-col
                    constraint:
                        - &product-program_id-fkey-cst
                            name: product_program_id_fkey
                            type: foreign_key
                            column: program_id
                            other_attributes:
                                foreign_table: master.program
                                foreign_column: id
                        # - &product-cross_id-fkey-cst
                        #     name: product_cross_id_fkey
                        #     type: foreign_key
                        #     column: cross_id
                        #     other_attributes:
                        #         foreign_table: operational.cross
                        #         foreign_column: id
                        <<: *def-log-tbl-cst
                    index:
                        - &product-program_id-idx
                            name: product_program_id_idx
                            column: program_id
                        - &product-designation-idx
                            name: product_designation_idx
                            column: designation
                        - &product-name_type-idx
                            name: product_name_type_idx
                            column: name_type
                        - &product-type-idx
                            name: product_type_idx
                            column: product_type
                        - &product-year-idx
                            name: product_year_idx
                            column: year
                        - &product-season_id-idx
                            name: product_season_id_idx
                            column: season_id
                        - &product-cross_id-idx
                            name: product_cross_id_idx
                            column: cross_id
                        - &product-generation-idx
                            name: product_generation_idx
                            column: generation
                        -
                            column: iris_preferred_id
                        -
                            column: breeding_line_name
                        -
                            column: derivative_name
                        -
                            column: fixed_line_name
                        <<: *def-log-tbl-idx
                - &master-product_name-tbl
                    <<: *def-tbl
                    name: product_name
                    comment: Different names and name types given to a product
                    column:
                        <<: *def-id-tbl-col
                        - &product_name-product_id-col
                            name: product_id
                            data_type: integer
                            not_null: true
                            type: system
                            comment: Product given with a particular name
                        - &product_name-name_type-col
                            name: name_type
                            data_type: varchar
                            not_null: true
                            type: system
                            comment: |
                                Type of the name: derivative, fixed_line, cultivar, common, others
                        - &product_name-value-col
                            name: value
                            data_type: varchar
                            not_null: true
                            type: system
                            comment: Value of the name
                        - &product_name-language_code-col
                            name: language_code
                            data_type: varchar
                            not_null: true
                            default_value: eng
                            type: system
                            comment: 'Language of the given name to the product (refer to: http://www.loc.gov/standards/iso639-2/php/code_list.php)'
                        <<: *def-desc-tbl-col
                        <<: *def-log-tbl-col
                    constraint:
                        - &product_name-product_id-fkey-cst
                            name: product_name_product_id_fkey
                            type: foreign_key
                            column: product_id
                            other_attributes:
                                foreign_table: master.product
                                foreign_column: id
                        <<: *def-log-tbl-cst
                    index:
                        - &product_name-product_id-idx
                            name: product_name_product_id_idx
                            column: product_id
                        - &product_name-name_type-idx
                            name: product_name_name_type_idx
                            column: name_type
                        <<: *def-log-tbl-idx
                - &master-product_gid-tbl
                    <<: *def-tbl
                    name: product_gid
                    comment: List of GIDs of a product; refers to its seed storage
                    column:
                        <<: *def-id-tbl-col
                        -
                            <<: *product_id-col
                            comment: Product assigned with a particular GID
                        -
                            <<: *gid-col
                            comment: GID assigned to a product
                        -
                            name: gid_type
                            data_type: varchar
                            type: system
                            comment: |
                                Type of GID of the product: fixed breeding line, cross, derivative, mgid (founding germplasm, from gms)
                        <<: *def-log-tbl-col
                    constraint:
                        -
                            name: product_gid_product_id_fkey
                            type: foreign_key
                            column: product_id
                            other_attributes:
                                foreign_table: master.product
                                foreign_column: id
                        -
                            type: unique_key
                            column:
                                - product_id
                                - gid
                        <<: *def-log-tbl-cst
                    index:
                        - *product_id-idx
                        -
                            name: product_gid_gid_idx
                            column: gid
                        <<: *def-log-tbl-idx
                - &master-product_study-tbl
                    <<: *def-tbl
                    name: product_study
                    comment: Products produced in a study
                    column:
                        <<: *def-id-tbl-col
                        -
                            <<: *product_id-col
                            comment: Produced material
                        -
                            <<: *study_id-col
                            comment: Study where the produced material belongs to
                        -
                            <<: *entry_id-col
                            not_null: false
                            comment: Entry where the product was harvested from
                        -
                            name: cross_id
                            data_type: integer
                            type: system
                            comment: Cross where the product is harvested from if applicable
                        <<: *def-log-tbl-col
                    constraint:
                        - *product_id-fkey-cst
                        # -
                        #     <<: *study_id-fkey-cst
                        #     other_attributes:
                        #         foreign_table: operational.study_id
                        #         foreign_column: id
                        # -
                        #     <<: *entry_id-fkey-cst
                        #     other_attributes:
                        #         foreign_table: operational.entry
                        #         foreign_column: id
                        # -
                        #     type: foreign_key
                        #     column: cross_id
                        #     other_attributes:
                        #         foreign_table: operational.cross
                        #         foreign_column: id
                        <<: *def-log-tbl-cst
                    index:
                        -
                            column:
                                - study_id
                                - product_id
                        -
                            column:
                                - study_id
                                - entry_id
                        -
                            column:
                                - study_id
                                - cross_id
                        <<: *def-log-tbl-idx
                - &master-product_metadata-tbl
                    <<: *def-tbl
                    name: product_metadata
                    comment: Additional information about a product
                    column:
                        <<: *def-id-tbl-col
                        - &product_metadata-variable_id-col
                            <<: *variable_id-col
                            comment: Metadata variable of the product
                        - &product_metadata-value-col
                            <<: *value-col
                            comment: Metadata value of the product
                        <<: *def-log-tbl-col
                    constraint:
                        - &product_metadata-variable_id-fkey-cst
                            name: product_metadata_variable_id_fkey
                            type: foreign_key
                            column: variable_id
                            other_attributes:
                                foreign_table: master.variable
                                foreign_column: id
                        <<: *def-tbl-cst
                    index:
                        <<: *def-log-tbl-idx
                - &master-season-tbl
                    <<: *def-tbl
                    name: season
                    comment: List of seasons
                    copy:
                        <<: *copy-val
                        column:
                            - abbrev
                            - name
                            - description
                    sequence:
                        start_with: 11
                        minvalue: 11
                        maxvalue: 99
                - &master-place_season-tbl
                    <<: *def-tbl
                    name: place_season
                    comment: List of seasons in a place
                    column:
                        <<: *def-id-tbl-col
                        - &place_season-place_id-col
                            <<: *place_id-col
                            comment: Place having that particular season
                        - &place_season-season_id-col
                            <<: *season_id-col
                            comment: Season in a given place
                        - &place_season-order_number-col
                            <<: *order_number-col
                        <<: *def-log-tbl-col
                    constraint:
                        - &place_season-place_id-fkey-cst
                            name: place_season_place_id_fkey
                            type: foreign_key
                            column: place_id
                            other_attributes:
                                foreign_table: master.place
                                foreign_column: id
                        - &place_season-season_id-fkey-cst
                            name: place_season_season_id_fkey
                            type: foreign_key
                            column: season_id
                            other_attributes:
                                foreign_table: master.season
                                foreign_column: id
                        -
                            type: unique_key
                            column:
                                - place_id
                                - season_id
                        -
                            type: unique_key
                            column:
                                - place_id
                                - order_number
                        <<: *def-tbl-cst
                    index:
                        -
                            column: place_id
                        -
                            column: season_id
                        -
                            unique: true
                            column:
                                - place_id
                                - season_id
                        -
                            unique: true
                            column:
                                - place_id
                                - order_number
                    copy:
                        <<: *copy-val
                        column:
                            - place_id
                            - season_id
                            - order_number
                - &master-cross_method-tbl
                    <<: *def-tbl
                    name: cross_method
                    comment: Methods used in crossing studies
                    copy:
                        <<: *copy-val
                        column:
                            - abbrev
                            - name
                            - description
                            - display_name
                - &master-family-tbl
                    <<: *def-tbl
                    name: family
                    column:
                        <<: *def-id-tbl-col
                        - *program_id-col
                        - *place_id-col
                        - *phase_id-col
                        - &family-female_product_id-col
                            name: female_product_id
                            data_type: integer
                            not_null: true
                            type: system
                            comment: Product used as female parent in the family
                        - &family-male_product_id-col
                            name: male_product_id
                            data_type: integer
                            not_null: true
                            type: system
                            comment: Product used as male parent in the family
                        -
                            <<: *study_id-col
                            not_null: false
                            comment: Study where the family came from
                        - &family-cross_id-col
                            name: cross_id
                            data_type: integer
                            type: system
                            comment: Cross of the family in a study
                        - &family-female_entry_id-col
                            name: female_entry_id
                            data_type: integer
                            type: system
                            comment: Study entry used as female in the family
                        - &family-male_entry_id-col
                            name: male_entry_id
                            data_type: integer
                            type: system
                            comment: Study entry used as male in the family
                        <<: *def-log-tbl-col
                    constraint:
                        -
                            type: foreign_key
                            column: female_product_id
                            other_attributes:
                                foreign_table: master.product
                                foreign_column: id
                        -
                            type: foreign_key
                            column: male_product_id
                            other_attributes:
                                foreign_table: master.product
                                foreign_column: id
                        # -
                        #     type: foreign_key
                        #     column: cross_id
                        #     other_attributes:
                        #         foreign_table: operational.cross
                        #         foreign_column: id
                        # -
                        #     type: foreign_key
                        #     column: female_entry_id
                        #     other_attributes:
                        #         foreign_table: operational.entry
                        #         foreign_column: id
                        # -
                        #     type: foreign_key
                        #     column: male_entry_id
                        #     other_attributes:
                        #         foreign_table: operational.entry
                        #         foreign_column: id
                        -
                            type: unique_key
                            column:
                                - female_product_id
                                - male_product_id
                        <<: *def-log-tbl-cst
                    index:
                        -
                            unique: true
                            column:
                                - female_product_id
                                - male_product_id
                        <<: *def-log-tbl-idx
            # system tables
                - &master-role-tbl
                    <<: *def-tbl
                    name: role
                    comment: Titles of privileged users that can perform definite actions
                    column:
                        <<: *def-id-tbl-col
                        <<: *def-meta-tbl-col
                        - *description-col
                        - *display_name-col
                        -
                            name: rank
                            data_type: smallint
                            default_value: -1
                            type: system
                            comment: '0: System admin; >0: Other users; <0: Guest/undefined'
                        <<: *def-log-tbl-col
                    constraint:
                        <<: *def-log-tbl-cst
                    index:
                        <<: *def-log-tbl-idx
                    copy:
                        <<: *copy-val
                        column:
                            - id
                            - abbrev
                            - name
                            - description
                            - display_name
                            - rank
                    sequence:
                        restart: true
                        start_with: 19
                - &master-item-tbl
                    <<: *def-tbl
                    name: item
                    comment: |
                        Processes, activities, tasks, and steps of the system
                    column:
                        <<: *def-id-tbl-col
                        <<: *def-meta-tbl-col
                        - &item-type-col
                            name: type
                            data_type: integer
                            type: system
                            comment: |
                                10: step; 20: task; 30: activity; 40: process
                        <<: *def-desc-tbl-col
                        <<: *def-log-tbl-col
                    copy:
                        <<: *copy-val
                        column:
                            - id
                            - abbrev
                            - name
                            - type
                            - description
                    sequence:
                        restart: true
                        start_with: 65
                - &master-item_relation-tbl
                    <<: *def-tbl
                    name: item_relation
                    comment: |
                        Hierarchical relationships of items (process -> activity -> task -> step)
                    column:
                        <<: *def-id-tbl-col
                        - &item_relation-parent_id-col
                            name: parent_id
                            data_type: integer
                            not_null: true
                            type: system
                            comment: Parent item
                        - &item_relation-child_id-col
                            name: child_id
                            data_type: integer
                            not_null: true
                            type: system
                            comment: Child item of the parent item
                        - &item_relation-order_number-col
                            <<: *order_number-col
                            comment: Order of the child in the list of children of the parent item
                        <<: *def-log-tbl-col
                    constraint:
                        -
                            type: foreign_key
                            column: parent_id
                            other_attributes:
                                foreign_table: master.item
                                foreign_column: id
                        -
                            type: foreign_key
                            column: child_id
                            other_attributes:
                                foreign_table: master.item
                                foreign_column: id
                        -
                            type: unique_key
                            column:
                                - parent_id
                                - child_id
                        <<: *def-log-tbl-cst
                    index:
                        -
                            column: parent_id
                        -
                            column: child_id
                        -
                            unique: true
                            column:
                                - parent_id
                                - child_id
                        -
                            unique: true
                            column:
                                - parent_id
                                - order_number
                        <<: *def-log-tbl-idx
                    copy:
                        <<: *copy-val
                        column:
                            - id
                            - parent_id
                            - child_id
                            - order_number
                    sequence:
                        restart: true
                        start_with: 35
                - &master-item_action-tbl
                    <<: *def-tbl
                    name: item_action
                    comment: 'Module, controller, and action IDs assigned to an item'
                    column:
                        <<: *def-id-tbl-col
                        - &item_action-item_id-col
                            name: item_id
                            data_type: integer
                            not_null: true
                            type: system
                            comment: Item which can be accessed by visiting module-controller-action
                        - &item_action-module-col
                            name: module
                            data_type: varchar
                            type: system
                            comment: Name of the module
                        - &item_action-controller-col
                            name: controller
                            data_type: varchar
                            not_null: true
                            type: system
                            comment: Name of the controller in a module (if applicable)
                        - &item_action-action-col
                            name: action
                            data_type: varchar
                            not_null: true
                            type: system
                            comment: Name of action in the controller
                        <<: *def-log-tbl-col
                    constraint:
                        -
                            type: foreign_key
                            column: item_id
                            other_attributes:
                                foreign_table: master.item
                                foreign_column: id
                        -
                            type: unique_key
                            column: item_id
                        -
                            type: unique_key
                            column:
                                - item_id
                                - module
                                - controller
                                - action
                        <<: *def-log-tbl-cst
                    index:
                        -
                            column: item_id
                        -
                            column:
                                - item_id
                                - module
                                - controller
                                - action
                        <<: *def-log-tbl-idx
                    copy:
                        <<: *copy-val
                        column:
                            - id
                            - item_id
                            - module
                            - controller
                            - action
                    sequence:
                        restart: true
                        start_with: 41
                - &master-team-tbl
                    <<: *def-tbl
                    name: team
                    comment: Groups users together in a pipeline or crosscutting team
                    column:
                        <<: *def-id-tbl-col
                        <<: *def-meta-tbl-col
                        - &team-leader_id-col
                            name: leader_id
                            data_type: integer
                            type: system
                            comment: User who leads the team
                        - &team-type-col
                            name: type
                            data_type: varchar
                            type: system
                            comment: 'Type of the team: pipeline; crosscutting'
                        <<: *def-desc-tbl-col
                        <<: *def-log-tbl-col
                    constraint:
                        -
                            name: team_leader_id_fkey
                            type: foreign_key
                            column: leader_id
                            other_attributes:
                                foreign_table: master.user
                                foreign_column: id
                        <<: *def-log-tbl-cst
                    index:
                        -
                            column: type
                        <<: *def-log-tbl-idx
                    copy:
                        <<: *copy-val
                        column:
                            - id
                            - abbrev
                            - name
                            - leader_id
                            - type
                            - description
                            - display_name
                            - is_void
                    sequence:
                        restart: true
                        start_with: 7
                - &master-user_item-tbl
                    <<: *def-tbl
                    name: user_item
                    comment: Items assigned to users
                    column:
                        <<: *def-id-tbl-col
                        - &user_item-user_id-col
                            <<: *user_id-col
                            comment: User assigned with role
                        - &user_item-item_id-col
                            <<: *item_id-col
                            comment: Item assigned to user
                        <<: *def-log-tbl-col
                    constraint:
                        - *user_id-fkey-cst
                        -
                            name: user_item_item_id_fkey
                            type: foreign_key
                            column: item_id
                            other_attributes:
                                foreign_table: master.item
                                foreign_column: id
                        -
                            type: unique_key
                            column:
                                - user_id
                                - item_id
                        <<: *def-log-tbl-col
                    index:
                        - *user_id-idx
                        -
                            column: item_id
                        -
                            unique: true
                            column:
                                - user_id
                                - item_id
                        <<: *def-log-tbl-idx
                    copy:
                        <<: *copy-val
                        column:
                            - id
                            - user_id
                            - item_id
                    sequence:
                        restart: true
                        start_with: 6
                - &master-user_role-tbl
                    <<: *def-tbl
                    name: user_role
                    comment: Roles assigned to users
                    column:
                        <<: *def-id-tbl-col
                        - &user_role-user_id-col
                            <<: *user_id-col
                            comment: User assigned with a role
                        - &user_role-role_id-col
                            name: role_id
                            data_type: integer
                            not_null: true
                            type: system
                            comment: Role assigned to a user
                        <<: *def-log-tbl-col
                    constraint:
                        - *user_id-fkey-cst
                        -
                            name: user_role_item_id_fkey
                            type: foreign_key
                            column: role_id
                            other_attributes:
                                foreign_table: master.role
                                foreign_column: id
                        # -
                        #     type: unique_key
                        #     column:
                        #         - user_id
                        #         - role_id
                        <<: *def-log-tbl-cst
                    index:
                        - *user_id-idx
                        -
                            name: user_role_role_id_idx
                            column: role_id
                        -
                            # unique: true
                            column:
                                - user_id
                                - role_id
                        <<: *def-log-tbl-idx
                    copy:
                        <<: *copy-val
                        column:
                            - id
                            - user_id
                            - role_id
                            - is_void
                    sequence:
                        restart: true
                        start_with: 76
                - &master-user_session-tbl
                    <<: *def-tbl
                    name: user_session
                    comment: Session data of users
                    column:
                        <<: *def-id-tbl-col
                        - &user_session-user_id-col
                            <<: *user_id-col
                        - &user_session-data-col
                            name: data
                            data_type: text
                            type: system
                            comment: Session data saved in JSON format
                        - &user_session-selected_pipeline_id-col
                            name: selected_pipeline_id
                            data_type: integer
                            type: system
                            comment: Pipeline where the user is currently into
                        - &user_session-last_visited_url-col
                            name: last_visited_url
                            data_type: varchar
                            type: system
                            comment: Last visited page of the user
                        - &user_session-is_default_redirect_yes-col
                            name: is_default_redirect_yes
                            data_type: boolean
                            default_value: false
                            type: system
                            comment: Redirect the user to the last visited page
                        - &user_session-is_default_redirect_no-col
                            name: is_default_redirect_no
                            data_type: boolean
                            default_value: false
                            type: system
                            comment: Do not redirect the user to the last visited page
                        <<: *def-log-tbl-col
                    constraint:
                        - *user_id-fkey-cst
                        <<: *def-log-tbl-cst
                    index:
                        - *user_id-idx
                        <<: *def-log-tbl-idx
                    copy:
                        <<: *copy-val
                        column:
                            - id
                            - user_id
                            - data
                            - selected_pipeline_id
                            - last_visited_url
                            - is_default_redirect_yes
                            - is_default_redirect_no
                    sequence:
                        restart: true
                        start_with: 17
                - &master-team_member-tbl
                    <<: *def-tbl
                    name: team_member
                    comment: Users belonging to teams
                    column:
                        <<: *def-id-tbl-col
                        -
                            name: team_id
                            data_type: integer
                            not_null: true
                            type: system
                            comment: Team with one or more members
                        -
                            name: member_id
                            data_type: integer
                            not_null: true
                            type: system
                            comment: User belonging to a team
                        -
                            name: role_id
                            data_type: integer
                            not_null: true
                            type: system
                            comment: Role of the user within the team
                        -
                            name: user_role_id
                            data_type: integer
                            type: system
                            comment: Refers to the role assigned to user in the user_role table
                        <<: *def-log-tbl-col
                    constraint:
                        -
                            name: team_member_team_id_fkey
                            type: foreign_key
                            column: team_id
                            other_attributes:
                                foreign_table: master.team
                                foreign_column: id
                        -
                            name: team_member_member_id_fkey
                            type: foreign_key
                            column: member_id
                            other_attributes:
                                foreign_table: master.user
                                foreign_column: id
                        -
                            name: team_member_role_id_fkey
                            type: foreign_key
                            column: role_id
                            other_attributes:
                                foreign_table: master.role
                                foreign_column: id
                        -
                            name: team_member_user_role_id_fkey
                            type: foreign_key
                            column: user_role_id
                            other_attributes:
                                foreign_table: master.user_role
                                foreign_column: id
                        -
                            type: unique_key
                            column:
                                - team_id
                                - member_id
                        -
                            type: unique_key
                            column:
                                - team_id
                                - member_id
                                - role_id
                        <<: *def-log-tbl-cst
                    index:
                        -
                            name: team_member_team_id_idx
                            column: team_id
                        -
                            name: team_member_member_id_idx
                            column: member_id
                        -
                            name: team_member_role_id_idx
                            column: role_id
                        -
                            name: team_member_user_role_id_idx
                            column: user_role_id
                        -
                            unique: true
                            column:
                                - team_id
                                - member_id
                        -
                            unique: true
                            column:
                                - team_id
                                - member_id
                                - role_id
                        <<: *def-log-tbl-idx
                    copy:
                        <<: *copy-val
                        column:
                            - id
                            - team_id
                            - member_id
                            - role_id
                            - user_role_id
                            - is_void
                    sequence:
                        restart: true
                        start_with: 62
                - &master-item_role-tbl
                    <<: *def-tbl
                    name: item_role
                    column:
                        <<: *def-id-tbl-col
                        -
                            name: item_id
                            data_type: integer
                            not_null: true
                            type: system
                            comment: Item assigned with the role
                        -
                            name: role_id
                            data_type: integer
                            not_null: true
                            type: system
                            comment: Role that can access the item
                        -
                            name: team_id
                            data_type: integer
                            not_null: true
                            type: system
                            comment: Team with the role that can access the item
                        <<: *def-log-tbl-col
                    constraint:
                        -
                            name: item_role_item_id_fkey
                            type: foreign_key
                            column: item_id
                            other_attributes:
                                foreign_table: master.item
                                foreign_column: id
                        -
                            name: item_role_role_id_fkey
                            type: foreign_key
                            column: role_id
                            other_attributes:
                                foreign_table: master.role
                                foreign_column: id
                        -
                            name: item_role_team_id_fkey
                            type: foreign_key
                            column: team_id
                            other_attributes:
                                foreign_table: master.team
                                foreign_column: id
                        # -
                        #     type: unique_key
                        #     column:
                        #         - item_id
                        #         - role_id
                        # -
                        #     type: unique_key
                        #     column:
                        #         - item_id
                        #         - role_id
                        #         - team_id
                        <<: *def-log-tbl-cst
                    index:
                        -
                            name: item_role_item_id_idx
                            column: item_id
                        -
                            name: item_role_role_id_idx
                            column: role_id
                        -
                            name: item_role_team_id_idx
                            column: team_id
                        -
                            # unique: true
                            column:
                                - item_id
                                - role_id
                        -
                            # unique: true
                            column:
                                - item_id
                                - role_id
                                - team_id
                        <<: *def-log-tbl-idx
                    copy:
                        <<: *copy-val
                        column:
                            - id
                            - item_id
                            - role_id
                            - team_id
                            - is_void
                    sequence:
                        restart: true
                        start_with: 147
                - &master-tooltip-tbl
                    <<: *def-tbl
                    name: tooltip
                    column:
                        <<: *def-id-tbl-col
                        -
                            <<: *name-col
                            comment: Name of the tooltip
                        -
                            <<: *value-col
                            comment: Value of the tooltip
                        -
                            <<: *description-col
                        <<: *def-log-tbl-col
                    constraint:
                        -
                            name: tooltip_name_ukey
                            type: unique_key
                            column: name
                        <<: *def-log-tbl-cst
                    index:
                        -
                            name: tooltip_name_idx
                            column: name
                            unique: true
                        <<: *def-log-tbl-idx
                    copy:
                        <<: *copy-val
                        column:
                            - id
                            - name
                            - value
                            - description
                            - is_void
                    sequence:
                        restart: true
                        start_with: 140
                - &master-instruction-tbl
                    <<: *def-tbl
                    name: instruction
                    comment: Instructions for users on how to use a feature in the system
                    column:
                        <<: *def-id-tbl-col
                        -
                            <<: *name-col
                            comment: Name of the instruction
                        -
                            <<: *value-col
                            comment: Value of the instruction to display
                        -
                            <<: *description-col
                            comment: Additional details about the instruction
                        <<: *def-log-tbl-col
                    constraint:
                        -
                            name: instruction_name_ukey
                            type: unique_key
                            column: name
                        <<: *def-log-tbl-cst
                    index:
                        -
                            name: instruction_name_idx
                            column: name
                            unique: true
                        <<: *def-log-tbl-idx
                    copy:
                        <<: *copy-val
                        column:
                            - id
                            - name
                            - value
                            - description
                            - is_void
                    sequence:
                        restart: true
                        start_with: 118
                - &master-audit-tbl
                    <<: *def-tbl
                    name: audit
                    column:
                        - &audit-id-col
                            <<: *id-col
                            data_type: bigserial
                        - &audit-schema_name-col
                            name: schema_name
                            data_type: varchar
                            not_null: true
                            type: system
                            comment: Schema name
                        - &audit-table_name-col
                            name: table_name
                            data_type: varchar
                            type: system
                            comment: Table name
                        - &audit-column_name-col
                            name: column_name
                            data_type: varchar
                            type: system
                            comment: Column name
                        - &audit-action_type-col
                            name: action_type
                            data_type: varchar
                            type: system
                            comment: 'Type of action performed on the record: insert, update, delete'
                        - &audit-record_id-col
                            name: record_id
                            data_type: numeric
                            type: system
                            comment: Record subjected to the action
                        - &audit-old_value-col
                            name: old_value
                            data_type: varchar
                            type: system
                            comment: 'Old value of the record before the update'
                        - &audit-value-col
                            name: value
                            data_type: varchar
                            type: system
                            comment: 'For insert, new value to be inserted; for update, new value of the updated record; for delete, value of the record to be deleted'
                        - &audit-actor_id-col
                            name: actor_id
                            data_type: integer
                            type: system
                            comment: User who performed the action
                        - &audit-action_timestamp-col
                            name: action_timestamp
                            data_type: timestamp
                            type: system
                            comment: Timestamp when the action was performed
                        -
                            <<: *status-col
                            type: system
                            comment: Needs clarification (forgotten why it's here)
                        <<: *def-log-tbl-col
                    constraint:
                        -
                            name: audit_actor_id_fkey
                            type: foreign_key
                            column: actor_id
                            other_attributes:
                                foreign_table: master.user
                                foreign_column: id
                        <<: *def-log-tbl-cst
                    index:
                        -
                            column:
                                - schema_name
                                - table_name
                                - column_name
                                - record_id
                        -
                            column: action_type
                        -
                            column: actor_id
                        -
                            column:
                                - action_type
                                - actor_id
                                - action_timestamp
                        <<: *def-log-tbl-idx
                - &master-changelog-tbl
                    <<: *def-tbl
                    name: changelog
                    column:
                        <<: *def-id-tbl-col
                        -
                            <<: *name-col
                            comment: Display name of the changelog record
                        -
                            <<: *description-col
                            comment: More details about the changes
                        -
                            name: key_person_id
                            data_type: integer
                            not_null: true
                            type: system
                            comment: User who implemented the feature
                        -
                            name: date_done
                            data_type: date
                            not_null: true
                            type: system
                            comment: Date when the feature was done
                        <<: *def-log-tbl-col
                    constraint:
                        -
                            name: change_log_key_person_id_fkey
                            type: foreign_key
                            column: key_person_id
                            other_attributes:
                                foreign_table: master.user
                                foreign_column: id
                        <<: *def-log-tbl-cst
                    index:
                        -
                            name: change_log_key_person_id_idx
                            column: key_person_id
                        <<: *def-log-tbl-idx
                    copy:
                        <<: *copy-val
                        column:
                            - id
                            - name
                            - description
                            - key_person_id
                            - date_done
                            - is_void
                    sequence:
                        restart: true
                        start_with: 14
            view:
                - &master-variable_list-view
                    name: variable_list
                    comment: 'Master list of variables, with their property, method, and scale values'
                    query: |
                        select
                            mv.id variable_id,
                            mv.abbrev,
                            mv.label,
                            mv.name,
                            mv.data_type,
                            mv.not_null,
                            mv.type,
                            mv.status,
                            mv.display_name,
                            mv.ontology_reference,
                            mv.bibliographical_reference,
                            mv.property_id,
                            mv.method_id,
                            mv.scale_id,
                            mp.abbrev property_abbrev,
                            mp.name property_name,
                            mp.description property_description,
                            mm.abbrev method_abbrev,
                            mm.name method_name,
                            mm.description method_description,
                            ms.abbrev scale_abbrev,
                            ms.name scale_name,
                            ms.description scale_description,
                            ms.unit scale_unit,
                            ms.type scale_type,
                            ms.level scale_level
                        from
                            master.variable mv,
                            master.property mp,
                            master.method mm,
                            master.scale ms
                        where
                            mv.property_id = mp.id
                            and mv.method_id = mm.id
                            and mv.scale_id = ms.id
                        order by
                            mv.id
                        ;
        - &dictionary-sch
            name: dictionary
            comment:
            table:
                - &dictionary-database-tbl
                    <<: *def-tbl
                    name: database
                    comment: Data sources
                    column:
                        <<: *def-id-tbl-col
                        <<: *def-meta-tbl-col
                        - &database-encoding-col
                            name: encoding
                            data_type: varchar
                            not_null: true
                            default_value: UTF8
                        - &database-lc_collate-col
                            name: lc_collate
                            data_type: varchar
                            not_null: true
                            default_value: C
                        - &database-lc_ctype-col
                            name: lc_ctype
                            data_type: varchar
                            not_null: true
                            default_value: C
                        - *comment-col
                        <<: *def-log-tbl-col
                - &dictionary-schema-tbl
                    <<: *def-tbl
                    name: schema
                    comment: Schemas in a database
                    column:
                        <<: *def-id-tbl-col
                        - *database_id-col
                        <<: *def-meta-tbl-col
                        - *comment-col
                        <<: *def-desc-tbl-col
                        <<: *def-log-tbl-col
                    constraint:
                        - *database_id-fkey-cst
                        <<: *def-tbl-cst
                - &dictionary-table-tbl
                    <<: *def-tbl
                    name: table
                    comment: Tables in a schema
                    column:
                        <<: *def-id-tbl-col
                        - *database_id-col
                        - *schema_id-col
                        <<: *def-meta-tbl-col
                        - *comment-col
                        <<: *def-desc-tbl-col
                        <<: *def-log-tbl-col
                    constraint:
                        - *database_id-fkey-cst
                        - *schema_id-fkey-cst
                        <<: *def-tbl-cst
                - &dictionary-column-tbl
                    <<: *def-tbl
                    name: column
                    comment: Columns of a table
                    column:
                        <<: *def-id-tbl-col
                        - *database_id-col
                        - *schema_id-col
                        - *table_id-col
                        <<: *def-meta-tbl-col
                        - &column-data_type-col
                            name: data_type
                            data_type: varchar
                            length: 32
                            not_null: true
                            comment: Type of data the column can store
                        - &column-length-col
                            name: length
                            data_type: varchar
                            length: 32
                            comment: Maximum character size for text data types or precision for numeric data types
                        - &column-not_null-col
                            name: not_null
                            data_type: boolean
                            not_null: true
                            default_value: false
                            comment: Whether the column will not allow null values
                        - &column-default_value-col
                            name: default_value
                            data_type: varchar
                            comment: Default value to fill in the column if value is not explicitly provided
                        - *comment-col
                        - *order_number-col
                        <<: *def-log-tbl-col
                    constraint:
                        - *database_id-fkey-cst
                        - *schema_id-fkey-cst
                        - *table_id-fkey-cst
                        <<: *def-tbl-cst
                - &dictionary-constraint-tbl
                    <<: *def-tbl
                    name: constraint
                    comment: Constraints of table columns
                    column:
                        <<: *def-id-tbl-col
                        - *database_id-col
                        - *schema_id-col
                        - *table_id-col
                        <<: *def-meta-tbl-col
                        - &constraint-type-col
                            name: type
                            data_type: varchar
                            comment: 'Primary key (primary_key), foreign key (foreign_key), or check (check) constraint'
                        -
                            name: column
                            data_type: varchar
                        -
                            name: foreign_table
                            data_type: varchar
                        -
                            name: foreign_column
                            data_type: varchar
                        - &constraint-on_update-col
                            name: on_update
                            data_type: varchar
                            not_null: true
                            default_value: cascade
                        - &constraint-on_delete-col
                            name: on_delete
                            data_type: varchar
                            not_null: true
                            default_value: cascade
                        - &constraint-match_type-col
                            name: match_type
                            data_type: varchar
                            not_null: true
                            default_value: simple
                        - &constraint-no_inherit-col
                            name: no_inherit
                            data_type: boolean
                            not_null: true
                            default_value: false
                        - &constraint-expression-col
                            name: expression
                            data_type: text
                        - &constraint-command-col
                            name: command
                            data_type: text
                            comment: SQL body command of the constraint
                        - *comment-col
                        # foreign tables and columns table_constraint
                        <<: *def-log-tbl-col
                    constraint:
                        - *database_id-fkey-cst
                        - *schema_id-fkey-cst
                        - *table_id-fkey-cst
                        <<: *def-tbl-cst
                - &dictionary-constraint_column-tbl
                    <<: *def-tbl
                    name: constraint_column
                    comment: 'Column/s subject of constraint'
                    column:
                        <<: *def-id-tbl-col
                        -
                            name: constraint_id
                            data_type: integer
                            not_null: true
                        -  &constraint-column_id-col
                            name: column_id
                            data_type: integer
                            not_null: true
                            comment: Subject column of the constraint
                        -
                            <<: *order_number-col
                        <<: *def-log-tbl-col
                    constraint:
                        -
                            type: foreign_key
                            column: constraint_id
                            other_attributes:
                                foreign_table: dictionary.constraint
                                foreign_column: id
                        -
                            type: foreign_key
                            column: column_id
                            other_attributes:
                                foreign_table: dictionary.column
                                foreign_column: id
                        <<: *def-log-tbl-cst
                    index:
                        <<: *def-log-tbl-idx
                - &dictionary-constraint_foreign-tbl
                    <<: *def-tbl
                    name: constraint_foreign
                    comment: 'Reference tables and columns of constraint'
                    column:
                        <<: *def-id-tbl-col
                        -
                            name: constraint_id
                            data_type: integer
                            not_null: true
                        -  &constraint-table_id-col
                            name: table_id
                            data_type: integer
                            not_null: true
                            comment: Reference talbe of the constraint
                        -  &constraint-column_id-col
                            name: column_id
                            data_type: integer
                            not_null: true
                            comment: Reference column of the constraint
                        -
                            <<: *order_number-col
                        <<: *def-log-tbl-col
                    constraint:
                        -
                            type: foreign_key
                            column: constraint_id
                            other_attributes:
                                foreign_table: dictionary.constraint
                                foreign_column: id
                        -
                            type: foreign_key
                            column: table_id
                            other_attributes:
                                foreign_table: dictionary.table
                                foreign_column: id
                        -
                            type: foreign_key
                            column: column_id
                            other_attributes:
                                foreign_table: dictionary.column
                                foreign_column: id
                        <<: *def-log-tbl-cst
                    index:
                        <<: *def-log-tbl-idx
                - &dictionary-index-tbl
                    <<: *def-tbl
                    name: index
                    comment: Indexes of table columns
                    column:
                        <<: *def-id-tbl-col
                        - *database_id-col
                        - *schema_id-col
                        - *table_id-col
                        <<: *def-meta-tbl-col
                        -
                            name: column
                            data_type:
                        - &index-using-col
                            name: using
                            data_type: varchar
                            comment: Algorithm to use in indexing
                        - &index-unique-col
                            name: unique
                            data_type: boolean
                            not_null: true
                            default_value: false
                            comment: Whether the index is unique or not
                        - &index-concurrent-col
                            name: concurrent
                            data_type: boolean
                            not_null: true
                            default_value: false
                            comment: Whether the index is concurrent or not
                        - *comment-col
                        <<: *def-log-tbl-col
                    constraint:
                        - *database_id-fkey-cst
                        - *schema_id-fkey-cst
                        - *table_id-fkey-cst
                        <<: *def-tbl-cst
                - &dictionary-index_column-tbl
                    <<: *def-tbl
                    name: index_column
                    comment: 'Column/s subject of index'
                    column:
                        <<: *def-id-tbl-col
                        -
                            name: index_id
                            data_type: integer
                            not_null: true
                        -  &constraint-column_id-col
                            name: column_id
                            data_type: integer
                            not_null: true
                            comment: Subject column of the index
                        -
                            <<: *order_number-col
                        <<: *def-log-tbl-col
                    constraint:
                        -
                            type: foreign_key
                            column: index_id
                            other_attributes:
                                foreign_table: dictionary.index
                                foreign_column: id
                        -
                            type: foreign_key
                            column: column_id
                            other_attributes:
                                foreign_table: dictionary.column
                                foreign_column: id
                        <<: *def-log-tbl-cst
                    index:
                        <<: *def-log-tbl-idx
                - &dictionary-rule-tbl
                    <<: *def-tbl
                    name: rule
                    comment: Rules
                    column:
                        <<: *def-id-tbl-col
                        - *database_id-col
                        - *schema_id-col
                        <<: *def-meta-tbl-col
                        - &rule-event-col
                            name: event
                            data_type: varchar
                            length: 16
                            not_null: true
                            default_value: select # insert, update, delete
                            comment: At what event/s the rule will be applied
                        -  &rule-execution-col
                            name: execution
                            data_type: varchar
                            length: 8
                            not_null: true
                            default_value: also
                            comment: Execution type of the rule
                        - &rule-condition-col
                            name: condition
                            data_type: text
                            comment: Conditional expression of the rule
                        - &rule-command-col
                            name: command
                            data_type: text
                            comment: SQL body command of the rule
                        - *comment-col
                        <<: *def-log-tbl-col
                    constraint:
                        - *database_id-fkey-cst
                        - *schema_id-fkey-cst
                        <<: *def-tbl-cst
                - &dictionary-trigger-tbl
                    <<: *def-tbl
                    name: trigger
                    comment: Triggers
                    column:
                        <<: *def-id-tbl-col
                        - *database_id-col
                        - *schema_id-col
                        <<: *def-meta-tbl-col
                        - &trigger-enabled-col
                            name: enabled
                            data_type: boolean
                            not_null: true
                            default_value: true
                            comment: Whether the trigger is enabled to execute or not
                        -  &trigger-execution-col
                            name: execution
                            data_type: varchar
                            not_null: true
                            default_value: before
                            comment: Execution type of trigger
                        - &trigger-for_each-col
                            name: for_each
                            data_type: varchar
                            not_null: true
                            default_value: row
                            comment: Apply trigger for each row or statement
                        - &trigger-event-col
                            name: event
                            data_type: varchar
                            default_value: insert # update, delete
                            comment: At what event/s the trigger will be executed
                        - &trigger-function-col
                            name: function
                            data_type: varchar
                            not_null: true
                        - &trigger-argument-col
                            name: argument
                            data_type: varchar
                        - &trigger-condition-col
                            name: condition
                            data_type: varchar
                        - *comment-col
                        <<: *def-log-tbl-col
                    constraint:
                        - *database_id-fkey-cst
                        - *schema_id-fkey-cst
                        <<: *def-tbl-cst
                - &dictionary-view-tbl
                    <<: *def-tbl
                    name: view
                    comment: Views
                    column:
                        <<: *def-id-tbl-col
                        - *database_id-col
                        - *schema_id-col
                        <<: *def-meta-tbl-col
                        -  &view-command-col
                            name: command
                            data_type: text
                            comment: SQL body command of the view
                        - *comment-col
                        <<: *def-log-tbl-col
                    constraint:
                        - *database_id-fkey-cst
                        - *schema_id-fkey-cst
                        <<: *def-tbl-cst
                - &dictionary-sequence-tbl
                    <<: *def-tbl
                    name: sequence
                    comment: Sequences
                    column:
                        <<: *def-id-tbl-col
                        - *database_id-col
                        - *schema_id-col
                        - *table_id-col
                        <<: *def-meta-tbl-col
                        - &sequence-start_value-col
                            name: value
                            data_type: integer
                            not_null: true
                            default_value: 1
                        - &sequence-increment-col
                            name: increment
                            data_type: integer
                            not_null: true
                            default_value: 1
                        - &sequence-minimum_value-col
                            name: minimum_value
                            data_type: integer
                            not_null: true
                            default_value: 1
                        - &sequence-maximum_value-col
                            name: maximum_value
                            data_type: integer
                            not_null: true
                            default_value: 2147483647
                        - &sequence-cache-col
                            name: cache
                            data_type: integer
                            not_null: true
                            default_value: 1
                        - &sequence-cycle-col
                            name: cycle
                            data_type: boolean
                            not_null: true
                            default_value: false
                        - *comment-col
                        <<: *def-log-tbl-col
                    constraint:
                        - *database_id-fkey-cst
                        - *schema_id-fkey-cst
                        <<: *def-tbl-cst
                - &dictionary-function-tbl
                    <<: *def-tbl
                    name: function
                    comment: Functions
                    column:
                        <<: *def-id-tbl-col
                        - *database_id-col
                        - *schema_id-col
                        <<: *def-meta-tbl-col
                        - &function-cycle-col
                            name: cycle
                            data_type: varchar
                            not_null: true
                            default_value: single_value
                        - &function-return_type-col
                            name: return_type
                            data_type: varchar
                            not_null: true
                            default_value: varchar
                        - &function-language-col
                            name: language
                            data_type: varchar
                            not_null: true
                            default_value: plpgsql
                        - &function-strict-col
                            name: strict
                            data_type: boolean
                            not_null: true
                            default_value: false
                        - &function-execution_privilege-col
                            name: execution_privilege
                            data_type: varchar
                            not_null: true
                            default_value: invoker
                        - &function-stability-col
                            name: stability
                            data_type: varchar
                            not_null: true
                            default_value: volatile
                        - *comment-col
                        <<: *def-log-tbl-col
                    constraint:
                        - *database_id-fkey-cst
                        - *schema_id-fkey-cst
                        <<: *def-tbl-cst
                - &dictionary-domain-tbl
                    <<: *def-tbl
                    name: domain
                    comment: Domains
                    column:
                        <<: *def-id-tbl-col
                        - *database_id-col
                        - *schema_id-col
                        <<: *def-meta-tbl-col
                        - &domain--col
                            name: data_type
                            data_type: varchar
                        - &domain-not_null-col
                            name: not_null
                            data_type: boolean
                            not_null: true
                            default_value: false
                        - &domain-default_value-col
                            name: default_value
                            data_type: varchar
                        - &domain-collation-col
                            name: collation
                            data_type: varchar
                            not_null: true
                            default_value: pg_catalog.C
                        - *comment-col
                        <<: *def-log-tbl-col
                    constraint:
                        - *database_id-fkey-cst
                        - *schema_id-fkey-cst
                        <<: *def-tbl-cst
                - &dictionary-aggregate-tbl
                    <<: *def-tbl
                    name: aggregate
                    comment: Aggregates
                    column:
                        <<: *def-id-tbl-col
                        - *database_id-col
                        - *schema_id-col
                        <<: *def-meta-tbl-col
                        - &aggregate-base_type-col
                            name: base_type
                            data_type: varchar
                            not_null: true
                            default_value: integer
                        - &aggregate-state_type-col
                            name: state_type
                            data_type: varchar
                            not_null: true
                            default_value: integer
                        - &aggregate-state_function_id-col
                            name: state_function_id
                            data_type: integer
                            not_null: true
                        - &aggregate-finale_function_id-col
                            name: final_function_id
                            data_type: integer
                        - &aggregate-initial_condition-col
                            name: initial_condition
                            data_type: text
                        - *comment-col
                        <<: *def-log-tbl-col
                    constraint:
                        - *database_id-fkey-cst
                        - *schema_id-fkey-cst
                        - &aggregate-state_function_id-fkey-cst
                            name: aggregate_state_function_id_fkey
                            type: foreign_key
                            column: state_function_id
                            comment: 'Foreign key constraint for the state_function_id column, which refers to the id column of dictionary.function table'
                            other_attributes:
                                foreign_table: dictionary.function
                                foreign_column: id
                        - &aggregate-final_function_id-fkey-cst
                            name: aggregate_final_function_id_fkey
                            type: foreign_key
                            column: final_function_id
                            comment: 'Foreign key constraint for the final_function_id column, which refers to the id column of dictionary.function table'
                            other_attributes:
                                foreign_table: dictionary.function
                                foreign_column: id
                        <<: *def-tbl-cst
        - &operational-sch
            name: operational
            comment: |
                Consist of the basic study, entry, plot, and subplot data, the study metadata, observation data and audit data
                produced in day-to-day data production events (knowledge work) in the product development programs
            table:
                - &operational-study-tbl
                    <<: *def-tbl
                    name: study
                    comment: Studies
                    column:
                        <<: *def-id-tbl-col
                        - &study-key-col
                            <<: *key-col
                            name: study_key
                            comment: 'Logical key of the study based on master data: program, place, phase, year, season, and study number (e.g., 1011000110120141111)'
                        - &study-program_id-col
                            <<: *program_id-col
                            comment: Product development program
                        - &study-place_id-col
                            <<: *place_id-col
                            comment: Place where the study is conducted
                        - &study-phase_id-col
                            <<: *phase_id-col
                        - &study-year-col
                            <<: *year-col
                            comment: Year when the study was conducted
                        - &study-season_id-col
                            <<: *season_id-col
                            comment: Season of the place when the study is conducted
                        - &study-study_number-col
                            name: study_number
                            data_type: integer
                            not_null: true
                            type: system
                            comment: 'Sequence number of the study; used to uniquely distinguish studies with the same program, place, phase, year, and season'
                        - &study-name-col
                            <<: *name-col
                            comment: 'Logical name of the study, which consists of the abbrev of the program, place, phase, year, season, and study number (e.g., IRSEA-IRRIHQ-HB-2013-DS-1)'
                        - &study-title-col
                            <<: *title-col
                            comment: Title of the study
                        - &study-is_draft-col
                            name: is_draft
                            data_type: boolean
                            default_value: true
                            type: system
                            comment: Whether the study is a draft or not
                        - &study-is_active-col
                            name: is_active
                            data_type: boolean
                            default_value: true
                            type: system
                            comment: Whether the study is active or not
                        <<: *def-log-tbl-col
                    constraint:
                        - &study-program_id-fkey-cst
                            name: study_program_id_fkey
                            type: foreign_key
                            column: program_id
                            other_attributes:
                                foreign_table: master.program
                                foreign_column: id
                        - &study-place_id-fkey-cst
                            name: study_place_id_fkey
                            type: foreign_key
                            column: place_id
                            other_attributes:
                                foreign_table: master.place
                                foreign_column: id
                        - &study-phase_id-fkey-cst
                            name: study_phase_id_fkey
                            type: foreign_key
                            column: phase_id
                            other_attributes:
                                foreign_table: master.phase
                                foreign_column: id
                        - &study-season_id-fkey-cst
                            name: study_season_id_fkey
                            type: foreign_key
                            column: season_id
                            other_attributes:
                                foreign_table: master.season
                                foreign_column: id
                        -
                            type: unique_key
                            column:
                                - study_key
                        -
                            name: study_operational_key_ukey
                            type: unique_key
                            column:
                                - program_id
                                - place_id
                                - phase_id
                                - year
                                - season_id
                                - study_number
                        -
                            type: unique_key
                            column:
                                - name
                        <<: *def-tbl-cst
                    index:
                        -
                            column:
                                - study_key
                        - &study-program_id-idx
                            column: program_id
                        - &study-place_id-idx
                            column: place_id
                        - &study-phase_id-idx
                            column: phase_id
                        - &study-year-idx
                            column: year
                        - &study-season_id-idx
                            column: season_id
                        - &study-year_season_id-idx
                            column:
                                - year
                                - season_id
                        -
                            name: study_operational_study_key_idx
                            column:
                                - program_id
                                - place_id
                                - phase_id
                                - year
                                - season_id
                                - study_number
                        - &study-name-idx
                            column: name
                        <<: *def-log-tbl-idx
                - &operational-study_metadata-tbl
                    <<: *def-tbl
                    name: study_metadata
                    comment: Metadata details of a study
                    column:
                        <<: *def-id-tbl-col
                        - *study_id-col
                        - *variable_id-col
                        - *value-col
                        <<: *def-log-tbl-col
                    constraint:
                        - *study_id-fkey-cst
                        - *variable_id-fkey-cst
                        <<: *def-tbl-cst
                    index:
                        - *study_id-idx
                        - *variable_id-idx
                        <<: *def-log-tbl-idx
                - &operational-entry-tbl
                    <<: *def-tbl
                    name: entry
                    comment: Entries of a study
                    column:
                        <<: *def-id-tbl-col
                        - &entry-key-col
                            <<: *key-col
                            name: entry_key
                            comment: Logical key of the entry
                        - &entry-study_id-col
                            <<: *study_id-col
                            comment: Study where the entry belongs to
                        - &entry-entno-col
                            <<: *number-col
                            name: entno
                            comment: Number of the entry within the study
                        - &entry-entcode-col
                            <<: *code-col
                            name: entcode
                            comment: Code of the entry within the study
                        - &entry-product_id-col
                            <<: *product_id-col
                            comment: Product as used as an entry
                        - &entry-product_gid-col
                            <<: *gid-col
                            name: product_gid
                            comment: GID of the product as a study entry
                        - &entry-product_name-col
                            <<: *name-col
                            name: product_name
                            type: metadata
                            comment: Name or designation used for the product as a study entry
                        - &entry-is_active-col
                            name: is_active
                            data_type: boolean
                            default_value: true
                            type: system
                            comment: Whether the entry is active or not
                        # - &entry-seed_storage_id-col
                        <<: *def-desc-tbl-col
                        <<: *def-log-tbl-col
                    constraint:
                        -
                            type: unique_key
                            column:
                                - entry_key
                        - &entry-study_id-fkey-cst
                            <<: *study_id-fkey-cst
                        - &entry-product_id-fkey-cst
                            <<: *product_id-fkey-cst
                        # - &entry-seed_storage_id-fkey-cst
                        -
                            type: unique_key
                            column:
                                - study_id
                                - entno
                        -
                            type: unique_key
                            column:
                                - study_id
                                - product_id
                            comment: Not applicable to HB; an entry/product may be planted more than once
                        <<: *def-tbl-cst
                    index:
                        -
                            column:
                                - entry_key
                        - &entry-study_id-idx
                            <<: *study_id-idx
                        - &entry-product_id-idx
                            <<: *product_id-idx
                        -
                            column:
                                - study_id
                                - entno
                        -
                            column:
                                - study_id
                                - product_id
                        <<: *def-log-tbl-idx
                - &operational-entry_metadata-tbl
                    <<: *def-tbl
                    name: entry_metadata
                    comment: Metadata of an entry
                    column:
                        <<: *def-id-tbl-col
                        - *study_id-col
                        - *entry_id-col
                        - *variable_id-col
                        - *value-col
                        <<: *def-log-tbl-col
                    constraint:
                        - *study_id-fkey-cst
                        - *entry_id-fkey-cst
                        - *variable_id-fkey-cst
                        <<: *def-tbl-cst
                    index:
                        - *study_id-idx
                        - *entry_id-idx
                        - *variable_id-idx
                        <<: *def-log-tbl-idx
                - &operational-entry_data-tbl
                    <<: *def-tbl
                    name: entry_data
                    comment: Observational data of an entry
                    column:
                        <<: *def-id-tbl-col
                        - *study_id-col
                        - *entry_id-col
                        - *variable_id-col
                        - *value-col
                        <<: *def-log-tbl-col
                    constraint:
                        - *study_id-fkey-cst
                        - *entry_id-fkey-cst
                        - *variable_id-fkey-cst
                        <<: *def-tbl-cst
                    index:
                        - *study_id-idx
                        - *entry_id-idx
                        - *variable_id-idx
                        <<: *def-log-tbl-idx
                - &operational-plot-tbl
                    <<: *def-tbl
                    name: plot
                    comment: Plot of a study entry
                    column:
                        <<: *def-id-tbl-col
                        - &plot-key-col
                            <<: *key-col
                            name: plot_key
                            comment: Logical key of the plot
                        - *study_id-col
                        - *entry_id-col
                        - &plot-rep-col
                            name: rep
                            data_type: integer
                            type: identification
                            comment: Replication number of a plot
                        - &plot-plotcode-col
                            <<: *code-col
                            comment: Code of the plot within the study
                        - &plot-plotno-col
                            name: plotno
                            data_type: integer
                            type: metadata
                            comment: Number of the plot within the study
                        <<: *def-desc-tbl-col
                        <<: *def-log-tbl-col
                    constraint:
                        -
                            type: unique_key
                            column:
                                - plot_key
                        - &plot-study_id-fkey-cst
                            <<: *study_id-fkey-cst
                        - &plot-entry_id-fkey-cst
                            <<: *entry_id-fkey-cst
                        -
                            type: unique_key
                            column:
                                - study_id
                                - entry_id
                                - rep
                        <<: *def-tbl-cst
                    index:
                        -
                            column:
                                - plot_key
                        - &plot-study_id-idx
                            <<: *study_id-idx
                        - &plot-entry_id-idx
                            <<: *entry_id-idx
                        -
                            column:
                                - study_id
                                - entry_id
                                - rep
                        <<: *def-log-tbl-idx
                - &operational-plot_metadata-tbl
                    <<: *def-tbl
                    name: plot_metadata
                    comment: Metadata of a plot
                    column:
                        <<: *def-id-tbl-col
                        - *study_id-col
                        - *entry_id-col
                        - *plot_id-col
                        - *variable_id-col
                        - *value-col
                        <<: *def-log-tbl-col
                    constraint:
                        - *study_id-fkey-cst
                        - *entry_id-fkey-cst
                        - *plot_id-fkey-cst
                        - *variable_id-fkey-cst
                        <<: *def-tbl-cst
                    index:
                        - *study_id-idx
                        - *entry_id-idx
                        - *plot_id-idx
                        - *variable_id-idx
                        <<: *def-log-tbl-idx
                - &operational-plot_data-tbl
                    <<: *def-tbl
                    name: plot_data
                    comment: Observational data of a plot
                    column:
                        <<: *def-id-tbl-col
                        - *study_id-col
                        - *entry_id-col
                        - *plot_id-col
                        - *variable_id-col
                        - *value-col
                        <<: *def-log-tbl-col
                    constraint:
                        - *study_id-fkey-cst
                        - *entry_id-fkey-cst
                        - *plot_id-fkey-cst
                        - *variable_id-fkey-cst
                        <<: *def-tbl-cst
                    index:
                        - *study_id-idx
                        - *entry_id-idx
                        - *plot_id-idx
                        - *variable_id-idx
                        <<: *def-log-tbl-idx
                - &operational-subplot-tbl
                    <<: *def-tbl
                    name: subplot
                    comment: Subplot of a study entry's plot
                    column:
                        <<: *def-id-tbl-col
                        - &subplot-key-col
                            <<: *key-col
                            name: subplot_key
                            comment: Logical key of the subplot
                        - *study_id-col
                        - *entry_id-col
                        - *plot_id-col
                        - &subplot-number-col
                            <<: *number-col
                            name: subplotno
                            type: identification
                            comment: Number of the subplot within the plot
                        <<: *def-desc-tbl-col
                        <<: *def-log-tbl-col
                    constraint:
                        -
                            type: unique_key
                            column:
                                - subplot_key
                        - &subplot-study_id-fkey-cst
                            <<: *study_id-fkey-cst
                        - &subplot-entry_id-fkey-cst
                            <<: *entry_id-fkey-cst
                        - &subplot-plot_id-fkey-cst
                            <<: *plot_id-fkey-cst
                        -
                            type: unique_key
                            column:
                                - study_id
                                - entry_id
                                - plot_id
                                - subplotno
                        <<: *def-tbl-cst
                    index:
                        -
                            column:
                                - subplot_key
                        - &subplot-study_id-idx
                            <<: *study_id-idx
                        - &subplot-entry_id-idx
                            <<: *entry_id-idx
                        - &subplot-plot_id-idx
                            <<: *plot_id-idx
                        -
                            column:
                                - study_id
                                - entry_id
                                - plot_id
                                - subplotno
                        <<: *def-log-tbl-idx
                - &operational-subplot_metadata-tbl
                    <<: *def-tbl
                    name: subplot_metadata
                    comment: Metadata of a subplot
                    column:
                        <<: *def-id-tbl-col
                        - *study_id-col
                        - *entry_id-col
                        - *plot_id-col
                        - *subplot_id-col
                        - *variable_id-col
                        - *value-col
                        <<: *def-log-tbl-col
                    constraint:
                        - *study_id-fkey-cst
                        - *entry_id-fkey-cst
                        - *plot_id-fkey-cst
                        - *subplot_id-fkey-cst
                        - *variable_id-fkey-cst
                        <<: *def-tbl-cst
                    index:
                        - *study_id-idx
                        - *entry_id-idx
                        - *plot_id-idx
                        - *subplot_id-idx
                        - *variable_id-idx
                        <<: *def-log-tbl-idx
                - &operational-subplot_data-tbl
                    <<: *def-tbl
                    name: subplot_data
                    comment: Observational data of a subplot
                    column:
                        <<: *def-id-tbl-col
                        - *study_id-col
                        - *entry_id-col
                        - *plot_id-col
                        - *subplot_id-col
                        - *variable_id-col
                        - *value-col
                        <<: *def-log-tbl-col
                    constraint:
                        - *study_id-fkey-cst
                        - *entry_id-fkey-cst
                        - *plot_id-fkey-cst
                        - *subplot_id-fkey-cst
                        - *variable_id-fkey-cst
                        <<: *def-tbl-cst
                    index:
                        - *study_id-idx
                        - *entry_id-idx
                        - *plot_id-idx
                        - *subplot_id-idx
                        - *variable_id-idx
                        <<: *def-log-tbl-idx
                - &operational-cross-tbl
                    <<: *def-tbl
                    name: cross
                    comment: Crosses in the hybridization stage
                    column:
                        <<: *def-id-tbl-col
                        - &cross-study_id-col
                            <<: *study_id-col
                        - &cross-product_id-col
                            <<: *product_id-col
                        - &cross-female_entry_id-col
                            <<: *entry_id-col
                            name: female_entry_id
                            comment: Female entry in the cross
                        - &cross-female_product_id-col
                            <<: *product_id-col
                            name: female_product_id
                            comment: Female product in the cross
                        - &cross-female_product_name-col
                            <<: *name-col
                            name: female_product_name
                            type: metadata
                            comment: Name or designation used for the female product in the cross
                        - &cross-male_entry_id-col
                            <<: *entry_id-col
                            name: male_entry_id
                            comment: Male entry in the cross
                        - &cross-male_product_id-col
                            <<: *product_id-col
                            name: male_product_id
                            comment: Male product in the cross
                        - &cross-male_product_name-col
                            <<: *name-col
                            name: male_product_name
                            type: metadata
                            comment: Name or designation used for the male product in the cross
                        - &cross-cross_method_id-col
                            name: cross_method_id
                            data_type: integer
                            not_null: true
                            type: system
                            comment: Method used in the cross
                        <<: *def-desc-tbl-col
                        <<: *def-log-tbl-col
                    constraint:
                        - &cross-study_id-fkey-cst
                            <<: *study_id-fkey-cst
                        - &cross-product_id-fkey-cst
                            <<: *product_id-fkey-cst
                        - &cross-female_entry_id-fkey-cst
                            <<: *entry_id-fkey-cst
                            name: cross_female_entry_id_fkey
                            column: female_entry_id
                        - &cross-female_product_id-fkey-cst
                            <<: *product_id-fkey-cst
                            name: cross_female_product_id_fkey
                            column: female_product_id
                        - &cross-male_entry_id-fkey-cst
                            <<: *entry_id-fkey-cst
                            name: cross_male_entry_id_fkey
                            column: male_entry_id
                        - &cross-male_product_id-fkey-cst
                            <<: *product_id-fkey-cst
                            name: cross_male_product_id_fkey
                            column: male_product_id
                        - &cross-cross_method_id-fkey-cst
                            name: cross_cross_method_id_fkey
                            type: foreign_key
                            column: cross_method_id
                            comment: 'Foreign key constraint for the cross_method_id column, which refers to the id column of the master.cross_method table'
                            other_attributes:
                                foreign_table: master.cross_method
                                foreign_column: id
                        -
                            type: unique_key
                            column:
                                - study_id
                                - product_id
                        -
                            type: unique_key
                            column:
                                - study_id
                                - female_product_id
                                - male_product_id
                        -
                            type: unique_key
                            column:
                                - study_id
                                - female_entry_id
                                - male_entry_id
                        <<: *def-tbl-cst
                    index:
                        - &cross-study_id-idx
                            <<: *study_id-idx
                        - &cross-product_id-idx
                            <<: *product_id-idx
                        - &cross-female_entry_id-idx
                            <<: *entry_id-fkey-cst
                            name: cross_female_entry_id_idx
                            column: female_entry_id
                        - &cross-female_product_id-idx
                            <<: *product_id-fkey-cst
                            name: cross_female_product_id_idx
                            column: female_product_id
                        - &cross-male_entry_id-idx
                            <<: *entry_id-fkey-cst
                            name: cross_male_entry_id_idx
                            column: male_entry_id
                        - &cross-male_product_id-idx
                            <<: *product_id-fkey-cst
                            name: cross_male_product_id_idx
                            column: male_product_id
                        - &cross-cross_method_id-idx
                            name: cross_cross_method_id_idx
                            column: cross_method_id
                        -
                            column:
                                - study_id
                                - product_id
                        -
                            column:
                                - study_id
                                - female_product_id
                                - male_product_id
                        -
                            column:
                                - study_id
                                - female_entry_id
                                - male_entry_id
                - &operational-cross_metadata-tbl
                    <<: *def-tbl
                    name: cross_metadata
                    comment: Metadata details about a cross
                    column:
                        <<: *def-id-tbl-col
                        - *study_id-col
                        - &cross_metadata-cross_id-col
                            name: cross_id
                            data_type: integer
                            not_null: true
                            type: system
                            comment: Cross
                        - *variable_id-col
                        - *value-col
                        <<: *def-log-tbl-col
                    constraint:
                        - *study_id-fkey-cst
                        - &cross_metadata-cross_id-fkey-cst
                            name: cross_metadata_cross_id_fkey
                            type: foreign_key
                            column: cross_id
                            other_attributes:
                                foreign_table: operational.cross
                                foreign_column: id
                        - *variable_id-fkey-cst
                        <<: *def-tbl-cst
                    index:
                        - *study_id-idx
                        - &cross_metadata-cross_id-idx
                            name: cross_metadata_cross_id_idx
                            column: cross_id
                        - *variable_id-idx
                        <<: *def-log-tbl-idx
                - &operational-cross_data-tbl
                    <<: *def-tbl
                    name: cross_data
                    comment: Observational data of a cross
                    column:
                        <<: *def-id-tbl-col
                        - *study_id-col
                        - &cross_data-cross_id-col
                            name: cross_id
                            data_type: integer
                            not_null: true
                            type: system
                            comment: Cross
                        - *variable_id-col
                        - *value-col
                        <<: *def-log-tbl-col
                    constraint:
                        - *study_id-fkey-cst
                        - &cross_data-cross_id-fkey-cst
                            name: cross_data_cross_id_fkey
                            type: foreign_key
                            column: cross_id
                            other_attributes:
                                foreign_table: operational.cross
                                foreign_column: id
                        - *variable_id-fkey-cst
                        <<: *def-tbl-cst
                    index:
                        - *study_id-idx
                        - &cross_data-cross_id-idx
                            name: cross_data_cross_id_idx
                            column: cross_id
                        - *variable_id-idx
                        <<: *def-log-tbl-idx
                - &operational-seed_storage-tbl
                    <<: *def-tbl
                    name: seed_storage
                    comment: |
                        Seed storage contains the product storage units. This gives information
                        on what material is available to be used in the product development programs.
                    column:
                        <<: *def-id-tbl-col
                        - &seed_storage-product_id-col
                            <<: *product_id-col
                            comment: Product where the seeds are harvested from
                        - &seed_storage-seed_lot_id-col
                            name: seed_lot_id
                            data_type: integer
                            not_null: true
                            type: system
                            comment: A unique identifier for the seed storage assigned by the data manager
                        - &seed_storage-key_type-col
                            name: key_type
                            data_type: varchar
                            not_null: true
                            type: system
                            comment: 'Type of seed storage key: family_id, entry_key, plot_key, custom_key, seed_lot_id, dummy_key'
                        - &seed_storage-seed_manager-col
                            name: seed_manager
                            data_type: varchar
                            not_null: true
                            type: system
                            comment: 'Refers to which product development programs has access to the seeds'
                        - &seed_storage-gid-col
                            <<: *gid-col
                            comment: Assigned GID to the product given the seed storage record
                        - &seed_storage-volume-col
                            name: volume
                            data_type: float
                            not_null: true
                            type: metadata
                            comment: Amount of material in the seed storage
                        - &seed_storage-unit-col
                            name: unit
                            data_type: varchar
                            not_null: true
                            type: system
                            comment: Scale to measure the amount of material
                        - &seed_storage-harvest_date-col
                            name: harvest_date
                            data_type: date
                            type: metadata
                            comment: Date when the material was harvested
                        - &seed_storage-label-col
                            name: label
                            data_type: varchar
                            not_null: true
                            type: metadata
                            comment: Metadata label about the seed storage
                        - &seed_storage-original_storage_id-col
                            name: original_storage_id
                            data_type: integer
                            type: system
                            comment: |
                                Null except in special cases when a seed lot is divided into several seed lots,
                                this contains the seed storage ID of the original seed lot that was divided
                        <<: *def-log-tbl-col
                    constraint:
                        - &seed_storage-product_id-fkey-cst
                            name: seed_storage_product_id_fkey
                            type: foreign_key
                            column: product_id
                            other_attributes:
                                foreign_table: master.product
                                foreign_column: id
                        -
                            type: unique_key
                            column:
                                - product_id
                                - seed_lot_id
                        -
                            type: unique_key
                            column:
                                - product_id
                                - gid
                                - seed_lot_id
                        <<: *def-log-tbl-cst
                        -
                            type: foreign_key
                            column: original_storage_id
                            other_attributes:
                                foreign_table: operational.seed_storage
                                foreign_column: id
                    index:
                        - &seed_storage-product_id-idx
                            name: seed_storage_product_id_idx
                            column: product_id
                        - &seed_storage-seed_lot_id-idx
                            name: seed_storage_seed_lot_id_idx
                            column: seed_lot_id
                            unique: true
                        - &seed_storage-gid-idx
                            name: seed_storage_gid_idx
                            column: gid
                            unique: true
                        - &seed_storage-original_storage_id-idx
                            name: seed_storage_original_storage_id_idx
                            column: original_storage_id
                        -
                            column:
                                - product_id
                                - seed_lot_id
                        <<: *def-log-tbl-idx
                - &operational-seed_storage_log-tbl
                    <<: *def-tbl
                    name: seed_storage_log
                    comment: Contains the history of transactions made to the seed storage record
                    column:
                        <<: *def-id-tbl-col
                        - &seed_storage_log-seed_storage_id-col
                            name: seed_storage_id
                            data_type: integer
                            not_null: true
                            type: system
                            comment: Seed storage of the product
                        - &seed_storage_log-encoder_id-col
                            name: encoder_id
                            data_type: integer
                            not_null: true
                            type: system
                            comment: User who entered the record
                        - &seed_storage_log-encode_timestamp-col
                            name: encode_timestamp
                            data_type: timestamp
                            not_null: true
                            type: system
                            comment: Timestamp when the transaction was done
                        - &seed_storage_log-transaction_type-col
                            name: transaction_type
                            data_type: varchar
                            not_null: true
                            type: system
                            comment: 'What was done to the seed storage record: deposit or withdraw'
                        - &seed_storage_log-volume-col
                            name: volume
                            data_type: float
                            not_null: true
                            type: metadata
                            comment: Volume deposited to or withdrawn from the seed storage record
                        - &seed_storage_log-unit-col
                            name: unit
                            data_type: varchar
                            not_null: true
                            type: metadata
                            comment: Scale used to measure what volume was deposited or withdrawn
                        - &seed_storage_log-event_timestamp-col
                            name: event_timestamp
                            data_type: timestamp
                            not_null: true
                            type: system
                            comment: Timestamp when the transaction was needed
                        - &seed_storage_log-sender-col
                            name: sender
                            data_type: varchar
                            type: metadata
                            comment: Where the deposited seeds come from
                        - &seed_storage_log-receiver-col
                            name: receiver
                            data_type: varchar
                            type: metadata
                            comment: Where the withdrawn seeds will go to
                        <<: *def-log-tbl-col
                    constraint:
                        - &seed_storage_log-seed_storage_id-fkey-cst
                            name: seed_storage_log_seed_storage_id_fkey
                            type: foreign_key
                            column: seed_storage_id
                            other_attributes:
                                foreign_table: operational.seed_storage
                                foreign_column: id
                        - &seed_storage_log-encoder_id-fkey-cst
                            name: seed_storage_log_encoder_id_fkey
                            type: foreign_key
                            column: encoder_id
                            other_attributes:
                                foreign_table: master.user
                                foreign_column: id
                        <<: *def-log-tbl-cst
                    index:
                        - &seed_storage_log-seed_storage_id-idx
                            name: seed_storage_log_seed_storage_id_idx
                            column: seed_storage_id
                        - &seed_storage-transaction_type-idx
                            name: seed_storage_transaction_type_idx
                            column: transaction_type
                        <<: *def-log-tbl-idx
        - &warehouse_terminal-sch
            name: warehouse_terminal
            comment: Terminal to warehouse data
            table:
                - &warehouse_terminal-transaction-tbl
                    <<: *def-tbl
                    name: transaction
                    comment: |
                        Transactions store events related to upload from imported data and commit to warehouse data.
                    column:
                        <<: *def-id-tbl-col
                        - &transaction-type-col
                            name: type
                            data_type: varchar
                            type: system
                            comment: |
                                Type of transaction 'upload': data source files to terminal; 'commit': terminal to data warehouse
                        - &transaction-actor_id-col
                            name: actor_id
                            data_type: integer
                            not_null: true
                            type: system
                            comment: |
                                User who performed the upload or commit action
                        - &transaction-start_action_timestamp-col
                            name: start_action_timestamp
                            data_type: timestamp
                            not_null: true
                            type: system
                            comment: |
                                Timestamp when the action started; starts from upload, reading contents, initial data validation, to saving to data warehouse terminal tables (study-, entry-, plot-level data)
                        - &transaction-end_action_timestamp-col
                            name: end_action_timestamp
                            data_type: timestamp
                            not_null: true
                            type: system
                            comment: |
                                Timestamp when the action ended; starts from upload, reading contents, initial data validation, to saving to data warehouse terminal tables (study-, entry-, plot-level data)
                        - &transaction-total_file_count-col
                            name: total_file_count
                            data_type: integer
                            not_null: true
                            type: system
                            comment: |
                                Total number of files uploaded or committed
                        - &transaction-successful_file_count-col
                            name: successful_file_count
                            data_type: integer
                            not_null: true
                            type: system
                            comment: |
                                Number of files that were successfully uploaded to data warehouse terminal or committed to data warehouse
                        - &transaction-is_successful-col
                            name: is_successful
                            data_type: boolean
                            not_null: true
                            default_value: false
                            type: system
                            comment: |
                                Whether upload or commit action is successfully done or not; successful meaning total_file_count is equal to successful_file_count
                        - &transaction-transfer_timestamp-col
                            name: transfer_timestamp
                            data_type: timestamp
                            type: system
                            comment: When was the transfer from operational to warehouse terminal or warehouse terminal to warehouse initiated
                        - &transaction-transferer_id-col
                            name: transferer_id
                            data_type: integer
                            type: system
                            comment: User who initiated the upload or commit transaction
                        - &transaction-data_source-col
                            name: data_source
                            data_type: varchar
                            type: system
                            comment: Source data files
                        <<: *def-log-tbl-col
                    constraint:
                        - &transaction-actor_id-fkey-cst
                            name: transaction_actor_id_fkey
                            type: foreign_key
                            column: actor_id
                            other_attributes:
                                foreign_table: master.user
                                foreign_column: id
                        - &transaction-transferer_id-fkey-cst
                            name: transaction_transferer_id_fkey
                            type: foreign_key
                            column: transferer_id
                            other_attributes:
                                foreign_table: master.user
                                foreign_column: id
                        <<: *def-log-tbl-cst
                    index:
                        - &transaction-type-idx
                            name: transaction_type_idx
                            column: type
                        - &transaction-actor_id-idx
                            name: transaction_actor_id_idx
                            column: actor_id
                        - &transaction-is_successful-idx
                            name: transaction_is_successful_idx
                            column: is_successful
                        - &transaction-transferer_id-idx
                            name: transaction_transferer_id_idx
                            column: transferer_id
                        <<: *def-log-tbl-idx
                - &warehouse_terminal-transaction_file-tbl
                    <<: *def-tbl
                    name: transaction_file
                    comment: Files uploaded or committed in a transaction
                    column:
                        <<: *def-id-tbl-col
                        - &transaction_file-transaction_id-col
                            name: transaction_id
                            data_type: integer
                            not_null: not_null
                            type: system
                            comment: Transaction where the file belongs to
                        - &transaction_file-data_level-col
                            name: data_level
                            data_type: varchar
                            not_null: true
                            type: system
                            comment: |
                                Data level where the file is supposed to be inserted to.
                                Possible values are study, entry, or plot.
                        - &transaction_file-name-col
                            name: name
                            data_type: varchar
                            not_null: true
                            type: system
                            comment: Name of the file
                        - &transaction_file-extension-col
                            name: extension
                            data_type: varchar
                            not_null: true
                            type: system
                            comment: Extension of the file
                        - &transaction_file-type-col
                            name: type
                            data_type: varchar
                            not_null: true
                            type: system
                            comment: Mimetype of the file
                        - &transaction_file-size-col
                            name: size
                            data_type: varchar
                            not_null: true
                            type: system
                            comment: Size of the file in bytes
                        - &transaction_file-contents-col
                            name: contents
                            data_type: text
                            not_null: true
                            type: system
                            comment: Contents of the file
                        <<: *def-log-tbl-col
                    constraint:
                        - &transaction_file-transaction_id-fkey-cst
                            name: transaction_file_transaction_id_fkey
                            type: foreign_key
                            column: transaction_id
                            other_attributes:
                                foreign_table: warehouse_terminal.transaction
                                foreign_column: id
                        <<: *def-log-tbl-cst
                    index:
                        - &transaction_file-transaction_id-idx
                            name: transaction_file_transaction_id_fkey
                            column: transaction_id
                        <<: *def-log-tbl-idx
                - &warehouse_terminal-study-tbl
                    <<: *def-tbl
                    name: study
                    comment: Studies
                    column:
                        <<: *def-id-tbl-col
                        - *transaction_id-col
                        - &study-program_name-col
                            name: program_name
                            data_type: varchar
                            not_null: true
                            type: identification
                            comment: Abbreviation of the program where the study belongs to
                        - &study-place_name-col
                            name: place_name
                            data_type: varchar
                            not_null: true
                            type: identification
                            comment: Abbreviation of the place where the study is conducted
                        - &study-phase_name-col
                            name: phase_name
                            data_type: varchar
                            not_null: true
                            type: identification
                            comment: Abbreviation of the breeding stage or special experiment of the study (collectively referred to as phase)
                        - &study-year-col
                            name: year
                            data_type: varchar
                            not_null: true
                            type: identification
                            comment: Year when the study was conducted
                        - &study-season-col
                            name: season
                            data_type: varchar
                            not_null: true
                            type: identification
                            comment: Abbreviation of the season when the study is conducted
                        - &study-name-col
                            <<: *name-col
                            type: identification
                            comment: Historical name of the study
                        <<: *def-log-tbl-col
                    constraint:
                        - *transaction_id-fkey-cst
                        <<: *def-log-tbl-cst
                    index:
                        - *transaction_id-idx
                        - &study-program_name-idx
                            name: study_program_name_idx
                            column: program_name
                        - &study-place_name-idx
                            name: study_place_name_idx
                            column: place_name
                        - &study-phase_name-idx
                            name: study_phase_name_idx
                            column: phase_name
                        - &study-year-idx
                            name: study_year_idx
                            column: year
                        - &study-season-idx
                            name: study_season_idx
                            column: season
                        - &study-name-idx
                            name: study_name_idx
                            column: name
                        <<: *def-log-tbl-idx
                - &warehouse_terminal-study_metadata-tbl
                    <<: *def-tbl
                    name: study_metadata
                    comment: Metadata of a study
                    column:
                        <<: *def-id-tbl-col
                        - *transaction_id-col
                        - *study_id-col
                        - *variable_id-col
                        - *value-col
                        <<: *def-log-tbl-col
                    constraint:
                        - *transaction_id-fkey-cst
                        - *study_id-fkey-cst
                        - *variable_id-fkey-cst
                        <<: *def-tbl-cst
                    index:
                        - *transaction_id-idx
                        - *study_id-idx
                        - *variable_id-idx
                        <<: *def-log-tbl-idx
                - &warehouse_terminal-study_variable-tbl
                    <<: *def-tbl
                    name: study_variable
                    comment: Variables in a study
                    column:
                        <<: *def-id-tbl-col
                        - *transaction_id-col
                        - *study_id-col
                        - &study_variable-data_level-col
                            name: data_level
                            data_type: varchar
                            not_null: true
                            type: system
                            comment: |
                                Data level where the variable is found; can be study, entry, plot
                        - *variable_id-col
                        - *order_number-col
                        <<: *def-log-tbl-col
                    constraint:
                        - *transaction_id-fkey-cst
                        - *study_id-fkey-cst
                        - *variable_id-fkey-cst
                        <<: *def-tbl-cst
                    index:
                        - *transaction_id-idx
                        - *study_id-idx
                        - *variable_id-idx
                        <<: *def-log-tbl-idx
                - &warehouse_terminal-entry-tbl
                    <<: *def-tbl
                    name: entry
                    comment: Entries of a study
                    column:
                        <<: *def-id-tbl-col
                        - *transaction_id-col
                        - *study_id-col
                        - &entry-study_name-col
                            name: study_name
                            data_type: varchar
                            not_null: true
                            type: identification
                            comment: Name of the study
                        - &entry-entry_number-col
                            name: entno
                            data_type: varchar
                            not_null: true
                            type: identification
                            comment: Numeric sequence of product as an entry in the study
                        - &entry-product_gid-col
                            <<: *gid-col
                            name: product_gid
                            data_type: varchar
                            not_null: true
                            type: metadata
                            comment: GID of the product in the study
                        - &entry-product_name-col
                            <<: *name-col
                            name: product_name
                            not_null: true
                            type: metadata
                            comment: Name of the product in the study
                        - &entry-seed_source_name-col
                            <<: *name-col
                            name: seed_source_name
                            type: metadata
                            comment: Source of seeds
                        <<: *def-log-tbl-col
                    constraint:
                        - *transaction_id-fkey-cst
                        - *study_id-fkey-cst
                        <<: *def-log-tbl-cst
                    index:
                        - *transaction_id-idx
                        - *study_id-idx
                        - &entry-study_name-idx
                            name: entry_study_name_idx
                            column: study_name
                        - &entry-entno-idx
                            name: entry_entno_idx
                            column: entno
                        - &entry-product_gid-idx
                            name: entry_product_gid_idx
                            column: product_gid
                        <<: *def-log-tbl-idx
                - &warehouse_terminal-entry_metadata-tbl
                    <<: *def-tbl
                    name: entry_metadata
                    comment: 
                    column:
                        <<: *def-id-tbl-col
                        - *transaction_id-col
                        - *study_id-col
                        - *entry_id-col
                        - *variable_id-col
                        - *value-col
                        <<: *def-log-tbl-col
                    constraint:
                        - *transaction_id-fkey-cst
                        - *study_id-fkey-cst
                        - *entry_id-fkey-cst
                        - *variable_id-fkey-cst
                        <<: *def-log-tbl-cst
                    index:
                        - *transaction_id-idx
                        - *study_id-idx
                        - *entry_id-idx
                        - *variable_id-idx
                        <<: *def-log-tbl-idx
                - &warehouse_terminal-entry_data-tbl
                    <<: *def-tbl
                    name: entry_data
                    comment: 
                    column:
                        <<: *def-id-tbl-col
                        - *transaction_id-col
                        - *study_id-col
                        - *entry_id-col
                        - *variable_id-col
                        - *value-col
                        <<: *def-log-tbl-col
                    constraint:
                        - *transaction_id-fkey-cst
                        - *study_id-fkey-cst
                        - *entry_id-fkey-cst
                        - *variable_id-fkey-cst
                        <<: *def-log-tbl-cst
                    index:
                        - *transaction_id-idx
                        - *study_id-idx
                        - *entry_id-idx
                        - *variable_id-idx
                        <<: *def-log-tbl-idx
                - &warehouse_terminal-entry_summary-tbl
                    <<: *def-tbl
                    name: entry_summary
                    comment: 
                    column:
                        <<: *def-id-tbl-col
                        - *transaction_id-col
                        - &entry_summary-trait-col
                            name: trait
                            data_type: varchar
                            type: system
                            column: Trait
                        - &entry_summary-observations-col
                            name: observations
                            data_type: varchar
                            type: system
                            column: Number of observations of the trait
                        - &entry_summary-min-col
                            name: min
                            data_type: varchar
                            type: system
                            comment: Minimum value for the trait
                        - &entry_summary-max-col
                            name: max
                            data_type: varchar
                            type: system
                            comment: Maximum value for the trait
                        - &entry_summary-average-col
                            name: average
                            data_type: varchar
                            type: system
                            comment: Average result of the trait observations
                        - &entry_summary-study_name-col
                            name: study_name
                            data_type: varchar
                            type: identification
                            comment: Name of study
                        # - *study_id-col
                        <<: *def-log-tbl-col
                    constraint:
                        - *transaction_id-fkey-cst
                        # - *study_id-fkey-cst
                        <<: *def-log-tbl-cst
                    index:
                        - *transaction_id-idx
                        - &entry_summary-study_name-idx
                            name: entry_summary_study_name_idx
                            column: study_name
                        <<: *def-log-tbl-idx
                - &warehouse_terminal-plot-tbl
                    <<: *def-tbl
                    name: plot
                    comment: Plot observations of entries in a study
                    column:
                        <<: *def-id-tbl-col
                        - *transaction_id-col
                        - *study_id-col
                        - &plot-study_name-col
                            name: study_name
                            data_type: varchar
                            not_null: true
                            type: identification
                            comment: Name of study
                        - &plot-entno-col
                            name: entno
                            data_type: varchar
                            not_null: true
                            type: identification
                            comment: Number of entry in the study
                        - &plot-product_gid-col
                            <<: *gid-col
                            name: product_gid
                            data_type: varchar
                            not_null: true
                            type: metadata
                            comment: GID of the product in the study
                        - &plot-product_name-col
                            <<: *name-col
                            name: product_name
                            not_null: true
                            type: metadata
                            comment: Name of the product in the study
                        - &plot-seed_source_name-col
                            <<: *name-col
                            name: seed_source_name
                            type: metadata
                            comment: Source of seeds
                        - &plot-rep-col
                            <<: *rep-col
                        <<: *def-log-tbl-col
                    constraint:
                        - *transaction_id-fkey-cst
                        - *study_id-fkey-cst
                        <<: *def-log-tbl-cst
                    index:
                        - *transaction_id-idx
                        - *study_id-idx
                        - &plot-study_name-idx
                            name: plot_study_name_idx
                            column: study_name
                        - &plot-entno-idx
                            name: plot_entno_idx
                            column: entno
                        - &plot-product_gid-idx
                            name: plot_product_gid_idx
                            column: product_gid
                        - &plot-rep-idx
                            name: plot_rep_idx
                            column: rep
                        <<: *def-log-tbl-idx
                - &warehouse_terminal-plot_metadata-tbl
                    <<: *def-tbl
                    name: plot_metadata
                    comment: 
                    column:
                        <<: *def-id-tbl-col
                        - *transaction_id-col
                        - *study_id-col
                        - *entry_id-col
                        - *plot_id-col
                        - *variable_id-col
                        - *value-col
                        <<: *def-log-tbl-col
                    constraint:
                        - *transaction_id-fkey-cst
                        - *study_id-fkey-cst
                        - *entry_id-fkey-cst
                        - *plot_id-fkey-cst
                        - *variable_id-fkey-cst
                        <<: *def-log-tbl-cst
                    index:
                        - *transaction_id-idx
                        - *study_id-idx
                        - *entry_id-idx
                        - *plot_id-idx
                        - *variable_id-idx
                        <<: *def-log-tbl-idx
                - &warehouse_terminal-plot_data-tbl
                    <<: *def-tbl
                    name: plot_data
                    comment: 
                    column:
                        <<: *def-id-tbl-col
                        - *transaction_id-col
                        - *study_id-col
                        - *entry_id-col
                        - *plot_id-col
                        - *variable_id-col
                        - *value-col
                        <<: *def-log-tbl-col
                    constraint:
                        - *transaction_id-fkey-cst
                        - *study_id-fkey-cst
                        - *entry_id-fkey-cst
                        - *plot_id-fkey-cst
                        - *variable_id-fkey-cst
                        <<: *def-log-tbl-cst
                    index:
                        - *transaction_id-idx
                        - *study_id-idx
                        - *entry_id-idx
                        - *plot_id-idx
                        - *variable_id-idx
                        <<: *def-log-tbl-idx
                - &warehouse_terminal-plot_summary-tbl
                    <<: *def-tbl
                    name: plot_summary
                    comment: 
                    column:
                        <<: *def-id-tbl-col
                        - *transaction_id-col
                        - &plot_summary-trait-col
                            name: trait
                            data_type: varchar
                            type: system
                            column: Trait
                        - &plot_summary-observations-col
                            name: observations
                            data_type: varchar
                            type: system
                            column: Number of observations of the trait
                        - &plot_summary-min-col
                            name: min
                            data_type: varchar
                            type: system
                            comment: Minimum value for the trait
                        - &plot_summary-max-col
                            name: max
                            data_type: varchar
                            type: system
                            comment: Maximum value for the trait
                        - &plot_summary-average-col
                            name: average
                            data_type: varchar
                            type: system
                            comment: Average result of the trait observations
                        - &plot_summary-study_name-col
                            name: study_name
                            data_type: varchar
                            type: identification
                            comment: Name of study
                        # - *study_id-col
                        <<: *def-log-tbl-col
                    constraint:
                        - *transaction_id-fkey-cst
                        # - *study_id-fkey-cst
                        <<: *def-log-tbl-cst
                    index:
                        - *transaction_id-idx
                        - &plot_summary-study_name-idx
                            name: plot_summary_study_name_idx
                            column: study_name
                        <<: *def-log-tbl-idx
                - &warehouse_terminal-temporary_data_upload-tbl
                    <<: *def-tbl
                    name: temporary_data_upload
                    comment: Temporary uploaded data
                    column:
                        <<: *def-id-tbl-col
                        - *transaction_id-col
                        - &temporary_data_upload-variable_name-col
                            name: variable_name
                            data_type: varchar
                            type: system
                            comment: Abbrev of variable
                        - &temporary_data_upload-variable_value-col
                            name: variable_value
                            data_type: varchar
                            type: system
                            comment: Value of the variable
                        - *user_id-col
                        <<: *def-log-tbl-col
                    constraint:
                        - *transaction_id-fkey-cst
                        - *user_id-fkey-cst
                        <<: *def-log-tbl-cst
                    index:
                        - *transaction_id-idx
                        - *user_id-idx
                        <<: *def-log-tbl-idx
        - &warehouse-sch
            name: warehouse
            comment: |
                Stores validated operational data
            table:
                - &warehouse-study-tbl
                    <<: *def-tbl
                    name: study
                    comment: Studies
                    column:
                        <<: *def-id-tbl-col
                        - &study-key-col
                            <<: *key-col
                            name: study_key
                            comment: Logical key of the study
                        - &study-program_id-col
                            <<: *program_id-col
                        - &study-place_id-col
                            <<: *place_id-col
                        - &study-phase_id-col
                            <<: *phase_id-col
                        - &study-year-col
                            <<: *year-col
                        - &study-season_id-col
                            <<: *season_id-col
                        - &study-study_number-col
                            <<: *number-col
                            name: study_number
                            comment: Sequence number of the study
                        - &study-study-col
                            <<: *name-col
                            name: study
                            comment: Historical name of the study
                        - &study-name-col
                            <<: *name-col
                            name: study_name
                            comment: Logical name of the study
                        - &study-title-col
                            <<: *title-col
                            name: study_title
                            comment: Title of the study
                        <<: *def-log-tbl-col
                    constraint:
                        -
                            type: unique_key
                            column:
                                - study_key
                        - &study-program_id-fkey-cst
                            name: study_program_id_fkey
                            type: foreign_key
                            column: program_id
                            other_attributes:
                                foreign_table: master.program
                                foreign_column: id
                        - &study-place_id-fkey-cst
                            name: study_place_id_fkey
                            type: foreign_key
                            column: place_id
                            other_attributes:
                                foreign_table: master.place
                                foreign_column: id
                        - &study-phase_id-fkey-cst
                            name: study_phase_id_fkey
                            type: foreign_key
                            column: phase_id
                            other_attributes:
                                foreign_table: master.phase
                                foreign_column: id
                        - &study-season_id-fkey-cst
                            name: study_season_id_fkey
                            type: foreign_key
                            column: season_id
                            other_attributes:
                                foreign_table: master.season
                                foreign_column: id
                        -
                            name: study_warehouse_study_key_ukey
                            type: unique_key
                            column:
                                - program_id
                                - place_id
                                - phase_id
                                - year
                                - season_id
                                - study_number
                        -
                            type: unique_key
                            column:
                                - study_name
                        <<: *def-tbl-cst
                    index:
                        - &study-key-idx
                            column:
                                - study_key
                        - &study-program_id-idx
                            name: study_program_id_idx
                            column: program_id
                        - &study-place_id-idx
                            name: study_place_id_idx
                            column: place_id
                        - &study-phase_id-idx
                            name: study_phase_id_idx
                            column: phase_id
                        - &study-year-idx
                            name: study_year_idx
                            column: year
                        - &study-season_id-idx
                            name: study_season_id_idx
                            column: season_id
                        - &study-year_season_id-idx
                            name: study_year_season_id_idx
                            column:
                                - year
                                - season_id
                        - &study-name-idx
                            name: study_name_idx
                            column: study_name
                        -
                            name: study_warehouse_study_key_idx
                            column:
                                - program_id
                                - place_id
                                - phase_id
                                - year
                                - season_id
                                - study_number
                        <<: *def-log-tbl-idx
                - &warehouse-entry-tbl
                    <<: *def-tbl
                    name: entry
                    comment: Entries of a study
                    column:
                        <<: *def-id-tbl-col
                        - &entry-key-col
                            <<: *key-col
                            name: entry_key
                            comment: Logical key of the entry
                        -
                            <<: *study_id-col
                        - &entry-number-col
                            <<: *number-col
                            name: entno
                            comment: Number of the entry within the study
                        - &entry-code-col
                            <<: *code-col
                            comment: Code of the entry within the study
                        - &entry-product_id-col
                            <<: *product_id-col
                        - &entry-product_gid-col
                            <<: *gid-col
                            name: product_gid
                        - &entry-product_name-col
                            <<: *name-col
                            name: product_name
                            type: metadata
                            comment: Name or designation used for the product within the study
                        # - &entry-seed_storage_id-col
                        <<: *def-desc-tbl-col
                        <<: *def-log-tbl-col
                    constraint:
                        -
                            type: unique_key
                            column: entry_key
                        - &entry-study_id-fkey-cst
                            <<: *study_id-fkey-cst
                        - &entry-product_id-fkey-cst
                            <<: *product_id-fkey-cst
                        # - &entry-seed_storage_id-fkey-cst
                        -
                            type: unique_key
                            column:
                                - study_id
                                - entno
                        -
                            type: unique_key
                            column:
                                - study_id
                                - product_id
                        <<: *def-tbl-cst
                    index:
                        - &entry-key-idx
                            column:
                                - entry_key
                        - &entry-study_id-idx
                            <<: *study_id-idx
                        - &entry-product_id-idx
                            <<: *product_id-idx
                        -
                            column:
                                - study_id
                                - entno
                        -
                            column:
                                - study_id
                                - product_id
                        <<: *def-log-tbl-idx
                - &warehouse-plot-tbl
                    <<: *def-tbl
                    name: plot
                    comment: Plot of a study entry
                    column:
                        <<: *def-id-tbl-col
                        - &plot-key-col
                            <<: *key-col
                            name: plot_key
                            comment: Logical key of the plot
                        -
                            <<: *study_id-col
                        -
                            <<: *entry_id-col
                        - &plot-rep-col
                            <<: *rep-col
                        - &plot-code-col
                            <<: *code-col
                            comment: Code of the plot within the study
                        - &plot-no-col
                            name: plotno
                            data_type: integer
                            type: metadata
                            comment: Number of plot in the study
                        <<: *def-desc-tbl-col
                        <<: *def-log-tbl-col
                    constraint:
                        -
                            type: unique_key
                            column: plot_key
                        - &plot-study_id-fkey-cst
                            <<: *study_id-fkey-cst
                        - &plot-entry_id-fkey-cst
                            <<: *entry_id-fkey-cst
                        -
                            type: unique_key
                            column:
                                - study_id
                                - entry_id
                                - rep
                        <<: *def-tbl-cst
                    index:
                        - &plot-key-idx
                            column:
                                - plot_key
                        - &plot-study_id-idx
                            <<: *study_id-idx
                        - &plot-entry_id-idx
                            <<: *entry_id-idx
                        -
                            column:
                                - study_id
                                - entry_id
                                - rep
                        <<: *def-log-tbl-idx
                - &warehouse-subplot-tbl
                    <<: *def-tbl
                    name: subplot
                    comment: Subplot of a study entry's plot
                    column:
                        <<: *def-id-tbl-col
                        - &subplot-key-col
                            <<: *key-col
                            name: subplot_key
                            comment: Logical key of the subplot
                        -
                            <<: *study_id-col
                        -
                            <<: *entry_id-col
                        -
                            <<: *plot_id-col
                        - &subplot-number-col
                            <<: *number-col
                            name: subplotno
                            comment: Number of the subplot within the plot
                        <<: *def-desc-tbl-col
                        <<: *def-log-tbl-col
                    constraint:
                        -
                            type: unique_key
                            column: subplot_key
                        - &subplot-study_id-fkey-cst
                            <<: *study_id-fkey-cst
                        - &subplot-entry_id-fkey-cst
                            <<: *entry_id-fkey-cst
                        - &subplot-plot_id-fkey-cst
                            <<: *plot_id-fkey-cst
                        -
                            type: unique_key
                            column:
                                - study_id
                                - entry_id
                                - plot_id
                                - subplotno
                        <<: *def-tbl-cst
                    index:
                        - &subplot-key-idx
                            column:
                                - subplot_key
                        - &subplot-study_id-idx
                            <<: *study_id-idx
                        - &subplot-entry_id-idx
                            <<: *entry_id-idx
                        - &subplot-plot_id-idx
                            <<: *plot_id-idx
                        -
                            column:
                                - study_id
                                - entry_id
                                - plot_id
                                - subplotno
                        <<: *def-log-tbl-idx
        - &import-sch
            name: import
            table:
                - &import-variable-tbl
                    <<: *def-tbl
                    name: variable
                    comment: Variable list by the data managers
                    column:
                        -
                            <<: *abbrev-col
                            not_null: false
                        -
                            name: label
                            data_type: varchar
                            not_null: false
                        -
                            name: name
                            data_type: varchar
                            not_null: false
                        -
                            name: description
                            data_type: varchar
                        -
                            name: data_type
                            data_type: varchar
                        -
                            name: not_null
                            data_type: varchar
                        -
                            name: type
                            data_type: varchar
                        -
                            <<: *status-col
                        -
                            name: display_name
                            data_type: varchar
                        -
                            name: ontology_reference
                            data_type: varchar
                        -
                            name: bibliographical_reference
                            data_type: varchar
                        -
                            name: property
                            data_type: varchar
                        -
                            name: method
                            data_type: varchar
                        -
                            name: scale
                            data_type: varchar
                        -
                            name: scale_unit
                            data_type: varchar
                        -
                            name: scale_type
                            data_type: varchar
                        -
                            name: scale_level
                            data_type: varchar
                        -
                            name: default_value
                            data_type: varchar
                        -
                            name: minimum_value
                            data_type: varchar
                        -
                            name: maximum_value
                            data_type: varchar
                        -
                            name: variable_set
                            data_type: varchar
                        -
                            name: synonym
                            data_type: varchar
                        -
                            name: entry_message
                            data_type: varchar
                        -
                            name: coded_values
                            data_type: varchar
                        <<: *def-id-tbl-col
                        <<: *def-log-tbl-col
                    index:
                        <<: *def-log-tbl-idx
                    copy:
                        <<: *copy-val
                        column:
                            - abbrev
                            - label
                            - name
                            - description
                            - data_type
                            - not_null
                            - type
                            - status
                            - display_name
                            - ontology_reference
                            - bibliographical_reference
                            - property
                            - method
                            - scale
                            - scale_unit
                            - scale_type
                            - scale_level
                            - default_value
                            - minimum_value
                            - maximum_value
                            - variable_set
                            - synonym
                            - entry_message
                            - coded_values
                            - notes
                - &import-hb_data-tbl
                    name: hb_data
                    column:
                        -
                            name: year
                            data_type: varchar
                        -
                            name: season
                            data_type: varchar
                        -
                            name: gid
                            data_type: varchar
                        -
                            name: designation
                            data_type: varchar
                        -
                            name: seed_source_name
                            data_type: varchar
                        -
                            name: cross_preferred_name
                            data_type: varchar
                        -
                            name: cross_unique_id
                            data_type: varchar
                        -
                            name: female_gid
                            data_type: varchar
                        -
                            name: female_preferred_name
                            data_type: varchar
                        -
                            name: female_line_name
                            data_type: varchar
                        -
                            name: male_gid
                            data_type: varchar
                        -
                            name: male_preferred_name
                            data_type: varchar
                        -
                            name: male_line_name
                            data_type: varchar
                        -
                            name: breeding_method_name
                            data_type: varchar
                        -
                            name: study_name
                            data_type: varchar
                        -
                            name: entry_code
                            data_type: varchar
                    copy:
                        <<: *copy-val
                - &import-f1_data-tbl
                    name: f1_data
                    column:
                        -
                            name: year
                            data_type: varchar
                        -
                            name: season
                            data_type: varchar
                        -
                            name: gid
                            data_type: varchar
                        -
                            name: designation
                            data_type: varchar
                        -
                            name: female_gid
                            data_type: varchar
                        -
                            name: female_preferred_name
                            data_type: varchar
                        -
                            name: female_designation
                            data_type: varchar
                        -
                            name: female_seed_source_name
                            data_type: varchar
                        -
                            name: male_gid
                            data_type: varchar
                        -
                            name: male_preferred_name
                            data_type: varchar
                        -
                            name: male_designation
                            data_type: varchar
                        -
                            name: male_seed_source_name
                            data_type: varchar
                        -
                            name: plot_number
                            data_type: varchar
                        -
                            name: seed_number
                            data_type: varchar
                        -
                            name: breeder
                            data_type: varchar
                        -
                            name: program_name
                            data_type: varchar
                        -
                            name: ecosystem_program_name
                            data_type: varchar
                        -
                            name: trait_team
                            data_type: varchar
                        -
                            name: research_group
                            data_type: varchar
                        -
                            name: division
                            data_type: varchar
                    copy:
                        <<: *copy-val
                - &import-rga_data-tbl
                    name: rga_data
                    column:
                        -
                            name: year
                            data_type: varchar
                        -
                            name: season
                            data_type: varchar
                        -
                            name: family_id
                            data_type: varchar
                        -
                            name: cross_number
                            data_type: varchar
                        -
                            name: gid
                            data_type: varchar
                        -
                            name: derive_name
                            data_type: varchar
                        -
                            name: code
                            data_type: varchar
                        -
                            name: purpose
                            data_type: varchar
                        -
                            name: pedigree
                            data_type: varchar
                        -
                            name: current_generation
                            data_type: varchar
                        -
                            name: seeding_date
                            data_type: varchar
                        -
                            name: seed_number
                            data_type: varchar
                        -
                            name: transplanting_date
                            data_type: varchar
                        -
                            name: transplanting_seed_number
                            data_type: varchar
                        -
                            name: recommended_rate
                            data_type: varchar
                        -
                            name: time_of_application_1
                            data_type: varchar
                        -
                            name: t1_fertilizer_type
                            data_type: varchar
                        -
                            name: das_1
                            data_type: varchar
                        -
                            name: t1_fertilizer_date
                            data_type: varchar
                        -
                            name: t1_fertilizer_amount
                            data_type: varchar
                        -
                            name: time_of_application_2
                            data_type: varchar
                        -
                            name: t2_fertilizer_type
                            data_type: varchar
                        -
                            name: das_2
                            data_type: varchar
                        -
                            name: t2_fertilizer_date
                            data_type: varchar
                        -
                            name: t2_fertilizer_amount
                            data_type: varchar
                        -
                            name: harvest_date
                            data_type: varchar
                        -
                            name: plant_number
                            data_type: varchar
                        -
                            name: germination_date
                            data_type: varchar
                        -
                            name: flowering_date
                            data_type: varchar
                        -
                            name: flowering_date_earliest
                            data_type: varchar
                        -
                            name: flowering_date_latest
                            data_type: varchar
                        -
                            name: remarks
                            data_type: varchar
                        -
                            name: for_checking_or_clarification
                            data_type: varchar
                    copy:
                        <<: *copy-val
                - &import-f2_data-tbl
                    name: f2_data
                    column:
                        -
                            name: program
                            data_type: varchar
                        -
                            name: study_name
                            data_type: varchar
                        -
                            name: entry_code
                            data_type: varchar
                        -
                            name: gid
                            data_type: varchar
                        -
                            name: designation
                            data_type: varchar
                        -
                            name: seed_source_name
                            data_type: varchar
                        -
                            name: family_designation
                            data_type: varchar
                        -
                            name: family_gid
                            data_type: varchar
                        -
                            name: pedigree_name
                            data_type: varchar
            options:
                skip_drop: false
                skip: false
        - &test-sch
            name: test
            comment: Temporary schema used for testing purposes only
            table:
                - &test-lookup-tbl
                    <<: *def-tbl
                    name: lookup
                    column:
                        <<: *def-id-tbl-col
                        <<: *def-meta-tbl-col
                        -
                            name: category
                            data_type: varchar
                        -
                            name: value
                            data_type: varchar
                        <<: *def-desc-tbl-col
                        <<: *def-log-tbl-col
                    constraint:
                        <<: *def-log-tbl-col
    options:
        drop_schema: true
        terminate_connections: true
        skip_append_sql: false
        dump: false
        append_sql: |
            create extension tablefunc;
            
            -- ---------------------------------------------------
            
            -- DROP TRIGGER add_variable_column ON master."variable";
            -- DROP FUNCTION public.add_variable_column();
            
            create or replace function "master"."add_variable_column"() returns trigger as $add_var_col$
            declare
                column_name varchar;
                data_type varchar;
                not_null varchar;
                
                add_column varchar;
            begin
                -- if (upper(new."type") = 'METADATA' or upper(new."type") = 'OBSERVATION') then
                if (upper(new."type") = 'OBSERVATION') then
                    -- column name
                    if (new."abbrev" is null or trim(new."abbrev") = '') then
                        column_name := '"' || lower(new."label") || '"';
                    else
                        column_name := '"' || lower(new."abbrev") || '"';
                    end if;
                    
                    -- data type
                    if (new."data_type" is null or trim(new."data_type") = '') then
                        data_type := 'varchar';
                    else
                        data_type := lower(new."data_type");
                    end if;
                    
                    -- not null
                    not_null := '';
                    if (new."not_null" = true) then
                        not_null := 'not null';
                    end if;
                    
                    add_column := 'add column ' || column_name || ' ' || data_type || ' ' || not_null;
                    
                    -- add column to warehouse.entry
                    execute
                        'alter table "warehouse"."entry" ' || add_column;
                    -- execute
                        -- 'comment on column "warehouse"."entry" is ' || description;
                    
                    -- add column to warehouse.plot
                    execute
                        'alter table "warehouse"."plot" ' || add_column;
                    -- execute
                        -- 'comment on column "warehouse"."plot" is ' || description;
                    
                    -- add column to warehouse.subplot
                    execute
                        'alter table "warehouse"."subplot" ' || add_column;
                    -- execute
                        -- 'comment on column "warehouse"."subplot" is ' || description;
                end if;
                
                return new;
            end;
            $add_var_col$ language plpgsql;
            
            drop trigger if exists "add_variable_column" on "master"."variable";
            create trigger "add_variable_column"
                after insert on "master"."variable"
                for each row execute procedure "master"."add_variable_column"();
            
            -- ---------------------------------------------------
            
            create or replace function "master"."drop_variable_column"() returns trigger as $drop_var_col$
            declare
                drop_column varchar;
            begin
                execute 'alter table "warehouse"."entry" drop column if exists "' || lower(old."abbrev") || '";';
                execute 'alter table "warehouse"."plot" drop column if exists "' || lower(old."abbrev") || '";';
                execute 'alter table "warehouse"."subplot" drop column if exists "' || lower(old."abbrev") || '";';
                
                return new;
            end;
            $drop_var_col$ language plpgsql;
            
            drop trigger if exists "drop_variable_column" on "master"."variable";
            create trigger "drop_variable_column"
                before delete on "master"."variable"
                for each row execute procedure "master"."drop_variable_column"();
            
            -- ---------------------------------------------------
            
            -- /*
            insert into
                master.property (
                    abbrev,
                    name,
                    description
                )
            select
                (
                    select
                        iv1.abbrev
                    from (
                        select
                            (
                                case
                                    when iv.abbrev is null
                                        then (
                                            case
                                                when iv.abbrev is null
                                                    then upper(replace(trim(iv.name), ' ', '_'))
                                                else
                                                    upper(replace(trim(iv.abbrev), ' ', '_'))
                                            end
                                        )
                                    else
                                        upper(replace(trim(iv.abbrev), ' ', '_'))
                                end
                            ) "abbrev"
                        from
                            import.variable iv
                        where
                            id = any(var.id_arr)
                    ) iv1
                    order by
                        char_length(iv1.abbrev) asc
                    limit 1
                ) "abbrev",
                lower(trim(var."name")) "name",
                array_to_string(var.description_arr, '\n') description
            from (
                select
                    lower(trim(iv."name")) "name",
                    count(iv.id) id_count,
                    array_agg(iv.description order by iv.id) description_arr,
                    array_agg(iv.id) id_arr
                from
                    import.variable iv
                group by
                    lower(trim(iv."name"))
            ) var
            ;
            
            -- ---------------------------------------------------
            
            insert into
                master.method (
                    abbrev,
                    name,
                    description
                )
            select
                upper(replace(trim(var."abbrev"), ' ', '_')) || '_METH_'
                    || row_number() over (partition by upper(trim("abbrev"))) "abbrev",
                var.name || ' ' || row_number() over (partition by lower(trim("name"))) "name",
                trim(var.method) description
            from (
                select
                    -- upper(trim(iv."abbrev")) "abbrev",
                    (
                        case
                            when iv.abbrev is null
                                then upper(replace(trim(iv.name), ' ', '_'))
                            else
                                upper(replace(trim(iv.abbrev), ' ', '_'))
                        end
                    ) "abbrev",
                    trim(iv.method) method,
                    lower(trim(iv."name")) "name"
                from
                    import.variable iv
                order by
                    iv.id
            ) var
            ;
            
            -- ---------------------------------------------------
            
            insert into
                master.scale (
                    abbrev,
                    name,
                    description,
                    unit,
                    type,
                    level
                )
            select
                upper(replace(trim(var."abbrev"), ' ', '_')) || '_SCALE_'
                    || row_number() over (partition by upper(trim("abbrev"))) "abbrev",
                var.name || ' ' || row_number() over (partition by lower(trim("name"))) "name",
                var.scale description,
                var.unit,
                var.type,
                var.level
            from (
                select
                    -- upper(trim(iv."abbrev")) "abbrev",
                    (
                        case
                            when iv.abbrev is null
                                then upper(replace(trim(iv.name), ' ', '_'))
                            else
                                upper(replace(trim(iv.abbrev), ' ', '_'))
                        end
                    ) "abbrev",
                    trim(iv.scale) scale,
                    lower(trim(iv.name)) "name",
                    trim(iv.scale_unit) unit,
                    trim(iv.scale_type) "type",
                    trim(iv.scale_level) "level"
                from
                    import.variable iv
                order by
                    iv.id
            ) var
            ;
            
            -- ---------------------------------------------------
            
            insert into master.variable (
                abbrev,
                label,
                name,
                data_type,
                not_null,
                type,
                status,
                display_name,
                ontology_reference,
                bibliographical_reference,
                property_id,
                method_id,
                scale_id,
                variable_set,
                description
            )
            select
                (
                    case
                        when var.abbrev is null
                            then case
                                when (
                                    select
                                        count(iv.id)
                                    from
                                        import.variable iv
                                    where
                                        upper(trim(iv.name)) = upper(trim(var.name))
                                ) >= 2 then
                                    var.label || '_' || (
                                        case when var.scale_type is null then ''
                                        else upper(substring(var.scale_type from 1 for 3)) || '_' end
                                    ) || row_number() over (partition by upper(trim(var.name)), upper(trim(substring(var.scale_type from 1 for 3))))
                                else
                                    var.label
                            end
                        else
                            var.abbrev
                    end
                ) abbrev,
                var.label,
                var.name,
                var.data_type,
                var.not_null,
                var.type,
                var.status,
                var.display_name,
                var.ontology_reference,
                var.bibliographical_reference,
                var.property_id,
                var.method_id,
                var.scale_id,
                var.variable_set,
                var.description
            from (
                select
                    var.abbrev,
                    upper(replace(
                        (
                            case
                                when var.label is null
                                    then var.property_abbrev
                                else
                                    var.label
                            end
                        ),
                    ' ', '_')) "label",
                    var.name,
                    (
                        case
                            when var.data_type is null or trim(var.data_type) = '' then
                                'varchar'
                            else
                                var.data_type
                        end
                    ) data_type,
                    var.not_null::bool,
                    var.type,
                    var.status,
                    (
                        case
                            when var.display_name is null then
                                initcap(var.name)
                            else
                                initcap(var.display_name)
                        end
                    ) display_name,
                    var.ontology_reference,
                    var.bibliographical_reference,
                    
                    var.property_id,
                    var.method_id,
                    var.scale_id,
                    
                    var.scale_type,
                    var.iv_id,
                    
                    var.variable_set,
                    
                    var.description
                from (
                    select
                        iv.iv_id,
                        
                        iv.abbrev,
                        iv.label,
                        iv.name,
                        iv.description,
                        iv.data_type,
                        (case
                            when iv.not_null = '' or iv.not_null is null
                                then 'false'
                            else
                                iv.not_null
                        end) not_null,
                        iv.type,
                        iv.status,
                        iv.display_name,
                        iv.ontology_reference,
                        iv.bibliographical_reference,
                        
                        (
                            select
                                -- mp.name
                                mp.id
                            from
                                master.property mp
                            where
                                mp.name = iv.name
                        ) property_id,
                        (
                            select
                                -- mm.name
                                mm.id
                            from
                                master.method mm
                            where
                                mm.name = iv.name || ' ' || num
                                -- and trim(mm.description) = iv.method
                        ) method_id,
                        (
                            select
                                -- ms.name
                                ms.id
                            from
                                master.scale ms
                            where
                                ms.name = iv.name || ' ' || num
                                -- and ms.description = iv.scale
                        ) scale_id,
                        (
                            select
                                -- ms.name
                                ms.type
                            from
                                master.scale ms
                            where
                                ms.name = iv.name || ' ' || num
                                -- and ms.description = iv.scale
                        ) scale_type,
                        
                        iv.variable_set,
                        
                        (
                            select
                                mp.abbrev
                            from
                                master.property mp
                            where
                                mp.name = iv.name
                        ) property_abbrev
                    from (
                        select
                            iv.id iv_id,
                            row_number() over (partition by lower(trim("name"))) num,
                            
                            upper(trim(iv.abbrev)) "abbrev",
                            upper(trim(iv.label)) "label",
                            lower(trim(iv.name)) "name",
                            trim(iv.description) description,
                            lower(trim(iv.data_type)) data_type,
                            lower(trim(iv.not_null)) not_null,
                            lower(trim(iv.type)) "type",
                            lower(trim(iv.status)) status,
                            trim(iv.display_name) display_name,
                            trim(iv.ontology_reference) ontology_reference,
                            trim(iv.bibliographical_reference) bibliographical_reference,
                            
                            trim(iv.method) "method",
                            trim(iv.scale) "scale",
                            
                            lower(trim(iv.variable_set)) variable_set
                        from
                            import.variable iv
                    ) iv
                ) var
                order by
                    var.iv_id
            ) var
            order by
                var.iv_id
            ;
            
            -- ---------------------------------------------------
            
            insert into master.variable_set (
                abbrev,
                name,
                display_name
            )
            select
                distinct on (
                    iv.variable_set
                )
                upper(replace(iv.variable_set, ' ', '_')) abbrev,
                lower(trim(iv.variable_set)) "name",
                initcap(iv.variable_set) display_name
            from (
                select
                    lower(trim(iv.variable_set)) variable_set
                from
                    import.variable iv
            ) iv
            where
                iv.variable_set is not null
            ;
            
            -- ---------------------------------------------------
            
            insert into master.variable_set_member (
                variable_set_id,
                variable_id,
                order_number
            )
            select
                (
                    select
                        mvs.id
                    from
                        master.variable_set mvs
                    where
                        upper(trim(mvs.name)) = upper(trim(mv.variable_set))
                ) variable_set_id,
                id variable_id,
                row_number() over (partition by upper(trim(mv.variable_set))) order_number
            from
                master.variable mv
            where
                mv.variable_set is not null
            order by
                mv.id
            ;
            -- */
...